{"config":{"lang":["ja"],"separator":"[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"BackcastPro \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<p>BackcastPro\u306f\u3001\u30c8\u30ec\u30fc\u30c7\u30a3\u30f3\u30b0\u6226\u7565\u306e\u305f\u3081\u306ePython\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002 **\u30ea\u30d7\u30ec\u30a4\u578b\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc**\u3067\u30011\u30d0\u30fc\u305a\u3064\u6642\u9593\u3092\u9032\u3081\u306a\u304c\u3089\u30c1\u30e3\u30fc\u30c8\u3068\u58f2\u8cb7\u3092\u53ef\u8996\u5316\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"#_1","title":"\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4e00\u89a7","text":""},{"location":"#_2","title":"\u30e6\u30fc\u30b6\u30fc\u5411\u3051\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb - \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\u3092\u5b66\u3076</li> <li>\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0 - \u3088\u304f\u3042\u308b\u554f\u984c\u3068\u89e3\u6c7a\u65b9\u6cd5</li> </ul>"},{"location":"#_3","title":"\u958b\u767a\u8005\u5411\u3051\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>\u958b\u767a\u8005\u30ac\u30a4\u30c9 - \u958b\u767a\u306b\u53c2\u52a0\u3059\u308b\u305f\u3081\u306e\u60c5\u5831</li> <li>\u7d04\u5b9a\u30ed\u30b8\u30c3\u30af\u5206\u6790\u30ec\u30dd\u30fc\u30c8 - \u58f2\u8cb7\u7d04\u5b9a\u6642\u306e\u4fa1\u683c\u6c7a\u5b9a\u30ed\u30b8\u30c3\u30af\u8a73\u7d30</li> <li>PyPI\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u65b9\u6cd5 - \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u914d\u5e03\u65b9\u6cd5</li> </ul>"},{"location":"#_4","title":"\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9","text":"<ul> <li>\u30b5\u30f3\u30d7\u30eb\u96c6 - \u5b9f\u7528\u7684\u306a\u6226\u7565\u306e\u4f8b</li> <li>marimo\u30ea\u30d7\u30ec\u30a4\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc - \u30b9\u30e9\u30a4\u30c0\u30fc\u3067\u6642\u9593\u64cd\u4f5c</li> <li>SMA\u30af\u30ed\u30b9\u6226\u7565\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3 - \u79fb\u52d5\u5e73\u5747\u8a08\u7b97</li> </ul>"},{"location":"#_5","title":"\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8","text":"<pre><code>import yfinance as yf\nfrom BackcastPro import Backtest\n\n# \u30c7\u30fc\u30bf\u3092\u53d6\u5f97\ncode = '7203.T'  # \u30c8\u30e8\u30bf\uff08\u6771\u8a3c\uff09\ndf = yf.download(code, period='1y')\n\n# \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3092\u521d\u671f\u5316\nbt = Backtest(data={code: df}, cash=10000)\n\n# \u6226\u7565\u95a2\u6570\u3092\u5b9a\u7fa9\ndef my_strategy(bt):\n    if bt.position == 0:\n        bt.buy(tag=\"entry\")\n\n# \u4e00\u62ec\u5b9f\u884c\nresults = bt.run_with_strategy(my_strategy)\nprint(results)\n</code></pre>"},{"location":"#_6","title":"\u4e3b\u306a\u6a5f\u80fd","text":"<ul> <li>\u30ea\u30d7\u30ec\u30a4\u578b\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc: <code>step()</code> \u30671\u30d0\u30fc\u305a\u3064\u9032\u3081\u306a\u304c\u3089\u30c1\u30e3\u30fc\u30c8\u78ba\u8a8d</li> <li>\u30b7\u30f3\u30d7\u30eb\u306a\u6226\u7565\u5b9f\u88c5: \u95a2\u6570\u30d9\u30fc\u30b9\u3067 <code>buy()</code> / <code>sell()</code> \u3092\u547c\u3076\u3060\u3051</li> <li>\u7d71\u8a08\u306e\u81ea\u52d5\u8a08\u7b97: \u4ee3\u8868\u7684\u306a\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6307\u6a19\u3092\u540c\u68b1</li> <li>\u30ea\u30b9\u30af\u7ba1\u7406: <code>sl</code> \u3068 <code>tp</code> \u306b\u6a19\u6e96\u5bfe\u5fdc</li> <li>\u53ef\u8996\u5316: <code>chart()</code> \u3067 plotly \u30ed\u30fc\u30bd\u30af\u8db3\u30c1\u30e3\u30fc\u30c8\u751f\u6210</li> <li>marimo\u9023\u643a: \u30b9\u30e9\u30a4\u30c0\u30fc\u3067\u6642\u9593\u3092\u64cd\u4f5c\u3057\u306a\u304c\u3089\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u53ef\u8996\u5316</li> </ul> <pre><code>flowchart TD\n    A[\"\u30c7\u30fc\u30bf\u6e96\u5099\"] --&gt; B[\"Backtest \u521d\u671f\u5316\"]\n    B --&gt; C[\"start() \u958b\u59cb\"]\n    C --&gt; D[\"strategy(bt) \u6226\u7565\u5b9f\u884c\"]\n    D --&gt; E[\"step() 1\u30d0\u30fc\u9032\u3081\u308b\"]\n    E --&gt; F{\"is_finished?\"}\n    F --&gt;|No| D\n    F --&gt;|Yes| G[\"finalize() \u7d71\u8a08\u8a08\u7b97\"]\n    G --&gt; H[\"\u7d50\u679c pd.Series\"]</code></pre>"},{"location":"#api","title":"API \u6982\u8981","text":""},{"location":"#_7","title":"\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e <code>start()</code> \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u958b\u59cb <code>step()</code> 1\u30d0\u30fc\u9032\u3081\u308b <code>reset()</code> \u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057 <code>goto(step, strategy)</code> \u6307\u5b9a\u4f4d\u7f6e\u307e\u3067\u9032\u3081\u308b <code>buy(code, size, tag, ...)</code> \u8cb7\u3044\u6ce8\u6587 <code>sell(code, size, tag, ...)</code> \u58f2\u308a\u6ce8\u6587 <code>chart(code)</code> \u30c1\u30e3\u30fc\u30c8\u751f\u6210 <code>finalize()</code> \u7d71\u8a08\u8a08\u7b97 <code>run_with_strategy(func)</code> \u4e00\u62ec\u5b9f\u884c"},{"location":"#_8","title":"\u30d7\u30ed\u30d1\u30c6\u30a3","text":"\u30d7\u30ed\u30d1\u30c6\u30a3 \u8aac\u660e <code>data</code> \u73fe\u5728\u6642\u70b9\u307e\u3067\u306e\u30c7\u30fc\u30bf <code>position</code> \u30dd\u30b8\u30b7\u30e7\u30f3\u30b5\u30a4\u30ba\uff08\u5168\u9298\u67c4\u5408\u8a08\uff09 <code>position_of(code)</code> \u6307\u5b9a\u9298\u67c4\u306e\u30dd\u30b8\u30b7\u30e7\u30f3 <code>equity</code> \u73fe\u5728\u306e\u8cc7\u7523 <code>cash</code> \u73fe\u5728\u306e\u73fe\u91d1 <code>current_time</code> \u73fe\u5728\u306e\u65e5\u6642 <code>progress</code> \u9032\u6357\u7387\uff080.0\u301c1.0\uff09 <code>is_finished</code> \u5b8c\u4e86\u30d5\u30e9\u30b0 <code>trades</code> \u30a2\u30af\u30c6\u30a3\u30d6\u306a\u53d6\u5f15 <code>closed_trades</code> \u6c7a\u6e08\u6e08\u307f\u53d6\u5f15 <code>orders</code> \u672a\u7d04\u5b9a\u306e\u6ce8\u6587"},{"location":"#_9","title":"\u30b5\u30dd\u30fc\u30c8","text":"<ul> <li>GitHub Issues: \u30d0\u30b0\u5831\u544a\u3084\u6a5f\u80fd\u8981\u6c42</li> <li>Discord: \u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u3067\u306e\u8cea\u554f</li> <li>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8: \u8a73\u7d30\u306a\u4f7f\u7528\u65b9\u6cd5\u306e\u78ba\u8a8d</li> </ul>"},{"location":"#_10","title":"\u30e9\u30a4\u30bb\u30f3\u30b9","text":"<p>MIT License - \u8a73\u7d30\u306fLICENSE\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"developer-guide/","title":"\u958b\u767a\u8005\u5411\u3051\u30ac\u30a4\u30c9","text":"<p>BackcastPro\u306e\u958b\u767a\u306b\u53c2\u52a0\u3059\u308b\u305f\u3081\u306e\u30ac\u30a4\u30c9\u3067\u3059\u3002</p>"},{"location":"developer-guide/#_2","title":"\u76ee\u6b21","text":"<ul> <li>\u958b\u767a\u74b0\u5883\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7</li> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020</li> <li>\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3</li> <li>\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u898f\u7d04</li> <li>\u30c6\u30b9\u30c8</li> <li>\u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3</li> <li>\u30ea\u30ea\u30fc\u30b9\u30d7\u30ed\u30bb\u30b9</li> </ul>"},{"location":"developer-guide/#_3","title":"\u958b\u767a\u74b0\u5883\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7","text":""},{"location":"developer-guide/#_4","title":"\u5fc5\u8981\u306a\u30c4\u30fc\u30eb","text":"<ul> <li>Python 3.9+</li> <li>Git</li> <li>pip</li> <li>\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\uff08VS Code\u63a8\u5968\uff09</li> </ul>"},{"location":"developer-guide/#_5","title":"\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u624b\u9806","text":"<ol> <li> <p>\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30af\u30ed\u30fc\u30f3 <pre><code>git clone https://github.com/BackcastPro/BackcastPro.git\ncd BackcastPro\n</code></pre></p> </li> <li> <p>\u4eee\u60f3\u74b0\u5883\u3092\u4f5c\u6210 <pre><code>python -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\n</code></pre></p> </li> <li> <p>\u4f9d\u5b58\u95a2\u4fc2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb <pre><code>python -m pip install -e .\npython -m pip install -r requirements.txt\n</code></pre></p> </li> <li> <p>\u958b\u767a\u7528\u4f9d\u5b58\u95a2\u4fc2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb <pre><code>python -m pip install pytest pytest-cov black flake8 mypy\n</code></pre></p> </li> </ol>"},{"location":"developer-guide/#vs-code","title":"VS Code\u8a2d\u5b9a","text":"<p><code>.vscode/settings.json</code>\u3092\u4f5c\u6210\uff1a</p> <pre><code>{\n    \"python.defaultInterpreterPath\": \".\\\\.venv\\\\Scripts\\\\python.exe\",\n    \"python.linting.enabled\": true,\n    \"python.linting.flake8Enabled\": true,\n    \"python.formatting.provider\": \"black\",\n    \"python.testing.pytestEnabled\": true,\n    \"python.testing.pytestArgs\": [\"tests\"]\n}\n</code></pre>"},{"location":"developer-guide/#_6","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020","text":"<pre><code>BackcastPro/\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 BackcastPro/\n\u2502       \u251c\u2500\u2500 __init__.py          # \u30e1\u30a4\u30f3\u30d1\u30c3\u30b1\u30fc\u30b8\n\u2502       \u251c\u2500\u2500 backtest.py          # \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u30a8\u30f3\u30b8\u30f3\n\u2502       \u251c\u2500\u2500 strategy.py          # \u6226\u7565\u57fa\u5e95\u30af\u30e9\u30b9\n\u2502       \u251c\u2500\u2500 _broker.py           # \u30d6\u30ed\u30fc\u30ab\u30fc\u5b9f\u88c5\n\u2502       \u251c\u2500\u2500 _stats.py            # \u7d71\u8a08\u8a08\u7b97\n\u2502       \u251c\u2500\u2500 order.py             # \u6ce8\u6587\u30af\u30e9\u30b9\n\u2502       \u251c\u2500\u2500 position.py          # \u30dd\u30b8\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\n\u2502       \u251c\u2500\u2500 trade.py             # \u30c8\u30ec\u30fc\u30c9\u30af\u30e9\u30b9\n\u2502       \u2514\u2500\u2500 data/\n\u2502           \u251c\u2500\u2500 __init__.py\n\u2502           \u2514\u2500\u2500 JapanStock.py    # \u30c7\u30fc\u30bf\u53d6\u5f97\n\u251c\u2500\u2500 tests/                       # \u30c6\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\n\u251c\u2500\u2500 docs/                        # \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n\u251c\u2500\u2500 examples/                    # \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 pyproject.toml              # \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n\u251c\u2500\u2500 requirements.txt            # \u4f9d\u5b58\u95a2\u4fc2\n\u2514\u2500\u2500 README.md                   # \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8aac\u660e\n</code></pre>"},{"location":"developer-guide/#_7","title":"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3","text":""},{"location":"developer-guide/#_8","title":"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8","text":""},{"location":"developer-guide/#1-backtest","title":"1. Backtest\u30af\u30e9\u30b9","text":"<ul> <li>\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u3092\u7ba1\u7406</li> <li>\u30c7\u30fc\u30bf\u3068\u6226\u7565\u3092\u7d71\u5408</li> <li>\u7d50\u679c\u306e\u8a08\u7b97\u3068\u8fd4\u5374</li> </ul>"},{"location":"developer-guide/#2-strategy","title":"2. Strategy\u30af\u30e9\u30b9","text":"<ul> <li>\u30c8\u30ec\u30fc\u30c7\u30a3\u30f3\u30b0\u6226\u7565\u306e\u57fa\u5e95\u30af\u30e9\u30b9</li> <li>\u30e6\u30fc\u30b6\u30fc\u304c\u6226\u7565\u3092\u5b9f\u88c5\u3059\u308b\u305f\u3081\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9</li> </ul>"},{"location":"developer-guide/#3-_broker","title":"3. _Broker\u30af\u30e9\u30b9","text":"<ul> <li>\u6ce8\u6587\u306e\u5b9f\u884c\u3068\u7ba1\u7406</li> <li>\u30dd\u30b8\u30b7\u30e7\u30f3\u3068\u30c8\u30ec\u30fc\u30c9\u306e\u8ffd\u8de1</li> <li>\u624b\u6570\u6599\u3068\u30b9\u30d7\u30ec\u30c3\u30c9\u306e\u8a08\u7b97</li> </ul>"},{"location":"developer-guide/#4","title":"4. \u30c7\u30fc\u30bf\u30e2\u30b8\u30e5\u30fc\u30eb","text":"<ul> <li>\u5916\u90e8API\u304b\u3089\u306e\u30c7\u30fc\u30bf\u53d6\u5f97</li> <li>\u30c7\u30fc\u30bf\u306e\u524d\u51e6\u7406\u3068\u5909\u63db</li> </ul>"},{"location":"developer-guide/#_9","title":"\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc","text":"<pre><code>1. \u30c7\u30fc\u30bf\u53d6\u5f97\n   \u2193\n2. \u6226\u7565\u521d\u671f\u5316 (Strategy.init)\n   \u2193\n3. \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u5b9f\u884c (Backtest.run)\n   \u2193\n4. \u5404\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3067\u6226\u7565\u5b9f\u884c (Strategy.next(current_time))\n   \u2193\n5. \u6ce8\u6587\u51e6\u7406 (_Broker.next(current_time))\n   \u2193\n6. \u7d71\u8a08\u8a08\u7b97 (_stats.compute_stats)\n   \u2193\n7. \u7d50\u679c\u8fd4\u5374\n</code></pre>"},{"location":"developer-guide/#_10","title":"\u30af\u30e9\u30b9\u56f3","text":"<pre><code>classDiagram\n    class Backtest {\n        +data: dict[str, DataFrame]\n        +strategy: Strategy\n        +run() Series\n    }\n\n    class Strategy {\n        +init()\n        +next(current_time)\n        +buy() Order\n        +sell() Order\n    }\n\n    class _Broker {\n        +equity: float\n        +position: Position\n        +trades: List[Trade]\n        +next(current_time)\n        +new_order() Order\n    }\n\n    class Order {\n        +size: float\n        +limit: float\n        +stop: float\n        +sl: float\n        +tp: float\n    }\n\n    class Position {\n        +size: float\n        +is_long: bool\n        +is_short: bool\n        +close()\n    }\n\n    class Trade {\n        +entry_price: float\n        +exit_price: float\n        +pl: float\n        +close()\n    }\n\n    Backtest --&gt; Strategy\n    Backtest --&gt; _Broker\n    Strategy --&gt; _Broker\n    _Broker --&gt; Order\n    _Broker --&gt; Position\n    _Broker --&gt; Trade</code></pre>"},{"location":"developer-guide/#_11","title":"\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u898f\u7d04","text":""},{"location":"developer-guide/#python","title":"Python\u30b9\u30bf\u30a4\u30eb","text":"<ul> <li>**PEP 8**\u306b\u6e96\u62e0</li> <li>**Black**\u3067\u30d5\u30a9\u30fc\u30de\u30c3\u30c8</li> <li>**flake8**\u3067\u30ea\u30f3\u30c8</li> <li>**mypy**\u3067\u578b\u30c1\u30a7\u30c3\u30af</li> </ul>"},{"location":"developer-guide/#_12","title":"\u547d\u540d\u898f\u5247","text":"<ul> <li>\u30af\u30e9\u30b9\u540d: PascalCase (\u4f8b: <code>Backtest</code>, <code>Strategy</code>)</li> <li>\u95a2\u6570\u540d: snake_case (\u4f8b: <code>run</code>, <code>calculate_stats</code>)</li> <li>\u5909\u6570\u540d: snake_case (\u4f8b: <code>data</code>, <code>strategy</code>)</li> <li>\u5b9a\u6570\u540d: UPPER_SNAKE_CASE (\u4f8b: <code>DEFAULT_CASH</code>)</li> </ul>"},{"location":"developer-guide/#_13","title":"\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>**docstring**\u306fGoogle\u5f62\u5f0f\u3092\u4f7f\u7528</li> <li>**\u578b\u30d2\u30f3\u30c8**\u3092\u5fc5\u9808\u3068\u3059\u308b</li> <li>**\u30b3\u30e1\u30f3\u30c8**\u306f\u65e5\u672c\u8a9e\u3067\u8a18\u8ff0</li> </ul>"},{"location":"developer-guide/#_14","title":"\u4f8b","text":"<pre><code>def calculate_rsi(data: pd.DataFrame, period: int = 14) -&gt; pd.Series:\n    \"\"\"\n    RSI\uff08\u76f8\u5bfe\u529b\u6307\u6570\uff09\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\n\n    Args:\n        data: OHLCV\u30c7\u30fc\u30bf\u3092\u542b\u3080DataFrame\n        period: RSI\u306e\u8a08\u7b97\u671f\u9593\uff08\u30c7\u30d5\u30a9\u30eb\u30c8: 14\uff09\n\n    Returns:\n        RSI\u5024\u3092\u542b\u3080Series\n\n    Raises:\n        ValueError: \u30c7\u30fc\u30bf\u304c\u7a7a\u306e\u5834\u5408\n    \"\"\"\n    if data.empty:\n        raise ValueError(\"\u30c7\u30fc\u30bf\u304c\u7a7a\u3067\u3059\")\n\n    # RSI\u8a08\u7b97\u30ed\u30b8\u30c3\u30af\n    delta = data['Close'].diff()\n    gain = delta.clip(lower=0.0)\n    loss = -delta.clip(upper=0.0)\n\n    avg_gain = gain.rolling(period, min_periods=period).mean()\n    avg_loss = loss.rolling(period, min_periods=period).mean()\n\n    rs = avg_gain / (avg_loss.replace(0, pd.NA))\n    return 100 - (100 / (1 + rs))\n</code></pre>"},{"location":"developer-guide/#_15","title":"\u30c6\u30b9\u30c8","text":""},{"location":"developer-guide/#_16","title":"\u30c6\u30b9\u30c8\u69cb\u9020","text":"<pre><code>tests/\n\u251c\u2500\u2500 test_backtest.py      # \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u306e\u30c6\u30b9\u30c8\n\u251c\u2500\u2500 test_strategy.py      # \u6226\u7565\u306e\u30c6\u30b9\u30c8\n\u251c\u2500\u2500 test_broker.py        # \u30d6\u30ed\u30fc\u30ab\u30fc\u306e\u30c6\u30b9\u30c8\n\u251c\u2500\u2500 test_data.py          # \u30c7\u30fc\u30bf\u53d6\u5f97\u306e\u30c6\u30b9\u30c8\n\u2514\u2500\u2500 fixtures/             # \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\n    \u251c\u2500\u2500 sample_data.csv\n    \u2514\u2500\u2500 test_strategies.py\n</code></pre>"},{"location":"developer-guide/#_17","title":"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c","text":"<pre><code># \u5168\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\npython -m pytest\n\n# \u30ab\u30d0\u30ec\u30c3\u30b8\u4ed8\u304d\u3067\u5b9f\u884c\npython -m pytest --cov=BackcastPro\n\n# \u7279\u5b9a\u306e\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\npython -m pytest tests/test_backtest.py\n\n# \u8a73\u7d30\u306a\u51fa\u529b\u3067\u5b9f\u884c\npython -m pytest -v\n</code></pre>"},{"location":"developer-guide/#_18","title":"\u30c6\u30b9\u30c8\u306e\u66f8\u304d\u65b9","text":"<pre><code>import pytest\nimport pandas as pd\nfrom BackcastPro import Backtest, Strategy\n\nclass TestStrategy(Strategy):\n    def init(self):\n        pass\n\n    def next(self, current_time):\n        for code, df in self.data.items():\n            if len(df) == 1:\n                self.buy(code=code)\n\ndef test_backtest_basic():\n    \"\"\"\u57fa\u672c\u7684\u306a\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u306e\u30c6\u30b9\u30c8\"\"\"\n    # \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n    data = pd.DataFrame({\n        'Open': [100, 101, 102],\n        'High': [105, 106, 107],\n        'Low': [99, 100, 101],\n        'Close': [104, 105, 106],\n        'Volume': [1000, 1100, 1200]\n    }, index=pd.date_range('2023-01-01', periods=3))\n\n    # \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\n    bt = Backtest({'TEST': data}, TestStrategy, cash=10000)\n    results = bt.run()\n\n    # \u7d50\u679c\u3092\u691c\u8a3c\n    assert results['Return [%]'] &gt; 0\n    assert results['# Trades'] &gt; 0\n    assert results['_strategy'] == 'TestStrategy'\n\ndef test_strategy_buy_sell():\n    \"\"\"\u6226\u7565\u306e\u8cb7\u3044\u58f2\u308a\u30ed\u30b8\u30c3\u30af\u306e\u30c6\u30b9\u30c8\"\"\"\n    strategy = TestStrategy(None, None)\n\n    # \u30e2\u30c3\u30af\u30c7\u30fc\u30bf\u3067\u30c6\u30b9\u30c8\n    mock_data = pd.DataFrame({\n        'Close': [100, 101, 102]\n    })\n    strategy._data = mock_data\n\n    # \u6226\u7565\u3092\u5b9f\u884c\n    strategy.next(pd.Timestamp('2023-01-01'))\n\n    # \u7d50\u679c\u3092\u691c\u8a3c\n    assert strategy.position.size &gt; 0\n</code></pre>"},{"location":"developer-guide/#_19","title":"\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\u306e\u4f7f\u7528","text":"<pre><code>@pytest.fixture\ndef sample_data():\n    \"\"\"\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u306e\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\"\"\"\n    return pd.DataFrame({\n        'Open': [100, 101, 102, 103, 104],\n        'High': [105, 106, 107, 108, 109],\n        'Low': [99, 100, 101, 102, 103],\n        'Close': [104, 105, 106, 107, 108],\n        'Volume': [1000, 1100, 1200, 1300, 1400]\n    }, index=pd.date_range('2023-01-01', periods=5))\n\n@pytest.fixture\ndef simple_strategy():\n    \"\"\"\u30b7\u30f3\u30d7\u30eb\u306a\u6226\u7565\u306e\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\"\"\"\n    class SimpleStrategy(Strategy):\n        def init(self):\n            pass\n        def next(self, current_time):\n            if len(self.data) == 1:\n                self.buy()\n    return SimpleStrategy\n\ndef test_with_fixtures(sample_data, simple_strategy):\n    \"\"\"\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\u3092\u4f7f\u7528\u3057\u305f\u30c6\u30b9\u30c8\"\"\"\n    bt = Backtest(sample_data, simple_strategy)\n    results = bt.run()\n    assert results['Return [%]'] &gt; 0\n</code></pre>"},{"location":"developer-guide/#_20","title":"\u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3","text":""},{"location":"developer-guide/#_21","title":"\u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u306e\u6d41\u308c","text":"<ol> <li>Issue\u3092\u4f5c\u6210 - \u30d0\u30b0\u5831\u544a\u3084\u6a5f\u80fd\u8981\u6c42</li> <li>Fork - \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30d5\u30a9\u30fc\u30af</li> <li>\u30d6\u30e9\u30f3\u30c1\u4f5c\u6210 - \u6a5f\u80fd\u30d6\u30e9\u30f3\u30c1\u3092\u4f5c\u6210</li> <li>\u958b\u767a - \u30b3\u30fc\u30c9\u3092\u5b9f\u88c5</li> <li>\u30c6\u30b9\u30c8 - \u30c6\u30b9\u30c8\u3092\u5b9f\u884c</li> <li>Pull Request - PR\u3092\u4f5c\u6210</li> <li>\u30ec\u30d3\u30e5\u30fc - \u30b3\u30fc\u30c9\u30ec\u30d3\u30e5\u30fc\u3092\u53d7\u3051\u308b</li> <li>\u30de\u30fc\u30b8 - \u30e1\u30a4\u30f3\u30d6\u30e9\u30f3\u30c1\u306b\u30de\u30fc\u30b8</li> </ol>"},{"location":"developer-guide/#_22","title":"\u30d6\u30e9\u30f3\u30c1\u547d\u540d\u898f\u5247","text":"<ul> <li><code>feature/\u6a5f\u80fd\u540d</code> - \u65b0\u6a5f\u80fd</li> <li><code>bugfix/\u30d0\u30b0\u540d</code> - \u30d0\u30b0\u4fee\u6b63</li> <li><code>docs/\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u540d</code> - \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u66f4\u65b0</li> <li><code>refactor/\u30ea\u30d5\u30a1\u30af\u30bf\u30ea\u30f3\u30b0\u540d</code> - \u30ea\u30d5\u30a1\u30af\u30bf\u30ea\u30f3\u30b0</li> </ul>"},{"location":"developer-guide/#_23","title":"\u30b3\u30df\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8","text":"<pre><code>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;\n\n&lt;body&gt;\n\n&lt;footer&gt;\n</code></pre> <p>\u4f8b: <pre><code>feat(backtest): \u30d7\u30ed\u30b0\u30ec\u30b9\u30d0\u30fc\u3092\u8ffd\u52a0\n\n\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u5b9f\u884c\u4e2d\u306b\u30d7\u30ed\u30b0\u30ec\u30b9\u30d0\u30fc\u3092\u8868\u793a\u3059\u308b\u6a5f\u80fd\u3092\u8ffd\u52a0\u3002\ntqdm\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u7528\u3057\u3066\u5b9f\u88c5\u3002\n\nCloses #123\n</code></pre></p>"},{"location":"developer-guide/#pull-request","title":"Pull Request","text":"<p>PR\u3092\u4f5c\u6210\u3059\u308b\u969b\u306f\u4ee5\u4e0b\u3092\u542b\u3081\u3066\u304f\u3060\u3055\u3044\uff1a</p> <ol> <li>\u5909\u66f4\u5185\u5bb9\u306e\u8aac\u660e</li> <li>\u30c6\u30b9\u30c8\u7d50\u679c</li> <li>\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\uff08UI\u5909\u66f4\u306e\u5834\u5408\uff09</li> <li>**\u95a2\u9023Issue**\u3078\u306e\u30ea\u30f3\u30af</li> </ol>"},{"location":"developer-guide/#_24","title":"\u30b3\u30fc\u30c9\u30ec\u30d3\u30e5\u30fc","text":"<p>\u30ec\u30d3\u30e5\u30fc\u6642\u306f\u4ee5\u4e0b\u3092\u78ba\u8a8d\uff1a</p> <ol> <li>\u30b3\u30fc\u30c9\u54c1\u8cea - \u53ef\u8aad\u6027\u3001\u4fdd\u5b88\u6027</li> <li>\u30c6\u30b9\u30c8 - \u30c6\u30b9\u30c8\u30ab\u30d0\u30ec\u30c3\u30b8</li> <li>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 - \u66f4\u65b0\u306e\u5fc5\u8981\u6027</li> <li>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9 - \u6027\u80fd\u3078\u306e\u5f71\u97ff</li> </ol>"},{"location":"developer-guide/#_25","title":"\u30ea\u30ea\u30fc\u30b9\u30d7\u30ed\u30bb\u30b9","text":""},{"location":"developer-guide/#_26","title":"\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406","text":"<ul> <li>**\u30bb\u30de\u30f3\u30c6\u30a3\u30c3\u30af\u30d0\u30fc\u30b8\u30e7\u30cb\u30f3\u30b0**\u3092\u4f7f\u7528</li> <li>**MAJOR.MINOR.PATCH**\u5f62\u5f0f</li> <li>MAJOR: \u7834\u58ca\u7684\u5909\u66f4</li> <li>MINOR: \u65b0\u6a5f\u80fd\u8ffd\u52a0</li> <li>PATCH: \u30d0\u30b0\u4fee\u6b63</li> </ul>"},{"location":"developer-guide/#_27","title":"\u30ea\u30ea\u30fc\u30b9\u624b\u9806","text":"<ol> <li> <p>\u30d0\u30fc\u30b8\u30e7\u30f3\u66f4\u65b0 <pre><code># pyproject.toml \u306e version \u3092\u66f4\u65b0\nversion = \"0.1.0\"\n</code></pre></p> </li> <li> <p>CHANGELOG\u66f4\u65b0 <pre><code>## [0.1.0] - 2023-01-01\n\n### Added\n- \u65b0\u6a5f\u80fdA\n- \u65b0\u6a5f\u80fdB\n\n### Changed\n- \u65e2\u5b58\u6a5f\u80fd\u306e\u6539\u5584\n\n### Fixed\n- \u30d0\u30b0\u4fee\u6b63A\n- \u30d0\u30b0\u4fee\u6b63B\n</code></pre></p> </li> <li> <p>\u30c6\u30b9\u30c8\u5b9f\u884c <pre><code>python -m pytest\npython -m pytest --cov=BackcastPro\n</code></pre></p> </li> <li> <p>\u30d3\u30eb\u30c9 <pre><code>python -m build\n</code></pre></p> </li> <li> <p>PyPI\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9 <pre><code>python -m twine upload dist/*\n</code></pre></p> </li> <li> <p>Git\u30bf\u30b0\u4f5c\u6210 <pre><code>git tag v0.1.0\ngit push origin v0.1.0\n</code></pre></p> </li> </ol>"},{"location":"developer-guide/#_28","title":"\u81ea\u52d5\u5316","text":"<p>GitHub Actions\u3092\u4f7f\u7528\u3057\u3066\u4ee5\u4e0b\u3092\u81ea\u52d5\u5316\uff1a</p> <ul> <li>\u30c6\u30b9\u30c8\u5b9f\u884c - PR\u4f5c\u6210\u6642</li> <li>\u30b3\u30fc\u30c9\u54c1\u8cea\u30c1\u30a7\u30c3\u30af - \u30ea\u30f3\u30c8\u3001\u30d5\u30a9\u30fc\u30de\u30c3\u30c8</li> <li>\u30d3\u30eb\u30c9 - \u30ea\u30ea\u30fc\u30b9\u6642</li> <li>PyPI\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9 - \u30bf\u30b0\u4f5c\u6210\u6642</li> </ul>"},{"location":"developer-guide/#_29","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316","text":""},{"location":"developer-guide/#_30","title":"\u30d7\u30ed\u30d5\u30a1\u30a4\u30ea\u30f3\u30b0","text":"<pre><code>import cProfile\nimport pstats\nfrom BackcastPro import Backtest\n\ndef profile_backtest():\n    \"\"\"\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30ea\u30f3\u30b0\"\"\"\n    # \u30d7\u30ed\u30d5\u30a1\u30a4\u30ea\u30f3\u30b0\u3092\u958b\u59cb\n    profiler = cProfile.Profile()\n    profiler.enable()\n\n    # \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\n    bt = Backtest(data, MyStrategy)\n    results = bt.run()\n\n    # \u30d7\u30ed\u30d5\u30a1\u30a4\u30ea\u30f3\u30b0\u3092\u505c\u6b62\n    profiler.disable()\n\n    # \u7d50\u679c\u3092\u8868\u793a\n    stats = pstats.Stats(profiler)\n    stats.sort_stats('cumulative')\n    stats.print_stats(10)\n\nif __name__ == \"__main__\":\n    profile_backtest()\n</code></pre>"},{"location":"developer-guide/#_31","title":"\u30e1\u30e2\u30ea\u4f7f\u7528\u91cf\u306e\u76e3\u8996","text":"<pre><code>import psutil\nimport os\n\ndef monitor_memory():\n    \"\"\"\u30e1\u30e2\u30ea\u4f7f\u7528\u91cf\u3092\u76e3\u8996\"\"\"\n    process = psutil.Process(os.getpid())\n\n    # \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u524d\n    memory_before = process.memory_info().rss / 1024 / 1024  # MB\n\n    # \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u5b9f\u884c\n    bt = Backtest(data, MyStrategy)\n    results = bt.run()\n\n    # \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u5f8c\n    memory_after = process.memory_info().rss / 1024 / 1024  # MB\n\n    print(f\"\u30e1\u30e2\u30ea\u4f7f\u7528\u91cf: {memory_after - memory_before:.2f} MB\")\n</code></pre>"},{"location":"developer-guide/#_32","title":"\u307e\u3068\u3081","text":"<p>\u3053\u306e\u958b\u767a\u8005\u5411\u3051\u30ac\u30a4\u30c9\u3067\u306f\u3001BackcastPro\u306e\u958b\u767a\u306b\u53c2\u52a0\u3059\u308b\u305f\u3081\u306e\u60c5\u5831\u3092\u63d0\u4f9b\u3057\u307e\u3057\u305f\uff1a</p> <ol> <li>\u958b\u767a\u74b0\u5883\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7 - \u5fc5\u8981\u306a\u30c4\u30fc\u30eb\u3068\u624b\u9806</li> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020 - \u30b3\u30fc\u30c9\u306e\u7d44\u7e54</li> <li>\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3 - \u30b7\u30b9\u30c6\u30e0\u306e\u8a2d\u8a08</li> <li>\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u898f\u7d04 - \u30b3\u30fc\u30c9\u30b9\u30bf\u30a4\u30eb\u3068\u54c1\u8cea</li> <li>\u30c6\u30b9\u30c8 - \u30c6\u30b9\u30c8\u306e\u66f8\u304d\u65b9\u3068\u5b9f\u884c</li> <li>\u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3 - \u8ca2\u732e\u306e\u65b9\u6cd5</li> <li>\u30ea\u30ea\u30fc\u30b9\u30d7\u30ed\u30bb\u30b9 - \u30ea\u30ea\u30fc\u30b9\u306e\u624b\u9806</li> </ol> <p>\u3053\u308c\u3089\u306e\u60c5\u5831\u3092\u53c2\u8003\u306b\u3001BackcastPro\u306e\u958b\u767a\u306b\u53c2\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"execution-logic-report/","title":"BackcastPro \u7d04\u5b9a\u30ed\u30b8\u30c3\u30af\u5206\u6790\u30ec\u30dd\u30fc\u30c8","text":""},{"location":"execution-logic-report/#_1","title":"\u6982\u8981","text":"<p>\u672c\u30ec\u30dd\u30fc\u30c8\u3067\u306f\u3001BackcastPro\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u304a\u3051\u308b\u58f2\u8cb7\u7d04\u5b9a\u6642\u306e\u4fa1\u683c\u6c7a\u5b9a\u30ed\u30b8\u30c3\u30af\u306b\u3064\u3044\u3066\u8a73\u3057\u304f\u5206\u6790\u3057\u307e\u3059\u3002Open, High, Low, **Close**\u306e\u3069\u306e\u5024\u304c\u7d04\u5b9a\u4fa1\u683c\u3068\u3057\u3066\u4f7f\u7528\u3055\u308c\u308b\u304b\u3092\u660e\u78ba\u306b\u3057\u307e\u3059\u3002</p>"},{"location":"execution-logic-report/#_2","title":"\u7d04\u5b9a\u4fa1\u683c\u6c7a\u5b9a\u306e\u57fa\u672c\u30ed\u30b8\u30c3\u30af","text":""},{"location":"execution-logic-report/#1-market-order","title":"1. \u6210\u884c\u6ce8\u6587\uff08Market Order\uff09\u306e\u7d04\u5b9a\u4fa1\u683c","text":"<p>\u6210\u884c\u6ce8\u6587\u306f\u3001<code>_broker.py</code>\u306e<code>_process_orders()</code>\u30e1\u30bd\u30c3\u30c9\u5185\u3067\u4ee5\u4e0b\u306e\u30ed\u30b8\u30c3\u30af\u3067\u51e6\u7406\u3055\u308c\u307e\u3059\uff1a</p> <pre><code># \u6210\u884c\u6ce8\u6587\uff08Market-if-touched / market order\uff09\n# \u6761\u4ef6\u4ed8\u304d\u6ce8\u6587\u306f\u5e38\u306b\u6b21\u306e\u59cb\u5024\u3067\nprev_close = df.Close.iloc[-2]\nprice = prev_close if self._trade_on_close and not order.is_contingent else open\n</code></pre>"},{"location":"execution-logic-report/#_3","title":"\u7d04\u5b9a\u4fa1\u683c\u6c7a\u5b9a\u30eb\u30fc\u30eb\uff1a","text":"<ol> <li><code>trade_on_close=False</code>\u306e\u5834\u5408\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\uff1a</li> <li>\u7d04\u5b9a\u4fa1\u683c = Open\uff08\u59cb\u5024\uff09</li> <li> <p>\u6b21\u306e\u30d0\u30fc\u306e\u59cb\u5024\u3067\u7d04\u5b9a</p> </li> <li> <p><code>trade_on_close=True</code>\u306e\u5834\u5408\uff1a</p> </li> <li>\u7d04\u5b9a\u4fa1\u683c = Close\uff08\u524d\u306e\u30d0\u30fc\u306e\u7d42\u5024\uff09</li> <li> <p>\u73fe\u5728\u306e\u30d0\u30fc\u306e\u7d42\u5024\u3067\u7d04\u5b9a</p> </li> <li> <p>\u6761\u4ef6\u4ed8\u304d\u6ce8\u6587\uff08SL/TP\u6ce8\u6587\uff09\u306e\u5834\u5408\uff1a</p> </li> <li>\u5e38\u306b**Open**\uff08\u59cb\u5024\uff09\u3067\u7d04\u5b9a</li> <li><code>trade_on_close</code>\u306e\u8a2d\u5b9a\u306b\u95a2\u4fc2\u306a\u304f</li> </ol>"},{"location":"execution-logic-report/#2-limit-order","title":"2. \u6307\u5024\u6ce8\u6587\uff08Limit Order\uff09\u306e\u7d04\u5b9a\u4fa1\u683c","text":"<p>\u6307\u5024\u6ce8\u6587\u306e\u7d04\u5b9a\u4fa1\u683c\u306f\u4ee5\u4e0b\u306e\u30ed\u30b8\u30c3\u30af\u3067\u6c7a\u5b9a\u3055\u308c\u307e\u3059\uff1a</p> <pre><code>if order.limit:\n    is_limit_hit = low &lt;= order.limit if order.is_long else high &gt;= order.limit\n    if not is_limit_hit or is_limit_hit_before_stop:\n        continue\n\n    # stop_price\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u3053\u306e\u30d0\u30fc\u5185\u3067\u6e80\u305f\u3055\u308c\u305f\n    price = (min(stop_price or open, order.limit)\n            if order.is_long else\n            max(stop_price or open, order.limit))\n</code></pre>"},{"location":"execution-logic-report/#_4","title":"\u7d04\u5b9a\u4fa1\u683c\u6c7a\u5b9a\u30eb\u30fc\u30eb\uff1a","text":"<ol> <li>\u30ed\u30f3\u30b0\u30dd\u30b8\u30b7\u30e7\u30f3\uff1a</li> <li>\u7d04\u5b9a\u6761\u4ef6\uff1a<code>Low &lt;= limit_price</code></li> <li> <p>\u7d04\u5b9a\u4fa1\u683c = <code>min(\u59cb\u5024 or \u30b9\u30c8\u30c3\u30d7\u4fa1\u683c, \u6307\u5024\u4fa1\u683c)</code></p> </li> <li> <p>\u30b7\u30e7\u30fc\u30c8\u30dd\u30b8\u30b7\u30e7\u30f3\uff1a</p> </li> <li>\u7d04\u5b9a\u6761\u4ef6\uff1a<code>High &gt;= limit_price</code></li> <li>\u7d04\u5b9a\u4fa1\u683c = <code>max(\u59cb\u5024 or \u30b9\u30c8\u30c3\u30d7\u4fa1\u683c, \u6307\u5024\u4fa1\u683c)</code></li> </ol>"},{"location":"execution-logic-report/#3-stop-order","title":"3. \u30b9\u30c8\u30c3\u30d7\u6ce8\u6587\uff08Stop Order\uff09\u306e\u7d04\u5b9a\u4fa1\u683c","text":"<p>\u30b9\u30c8\u30c3\u30d7\u6ce8\u6587\u306f\u4ee5\u4e0b\u306e\u30ed\u30b8\u30c3\u30af\u3067\u51e6\u7406\u3055\u308c\u307e\u3059\uff1a</p> <pre><code># \u30b9\u30c8\u30c3\u30d7\u6761\u4ef6\u304c\u6e80\u305f\u3055\u308c\u305f\u304b\u30c1\u30a7\u30c3\u30af\nstop_price = order.stop\nif stop_price:\n    is_stop_hit = ((high &gt;= stop_price) if order.is_long else (low &lt;= stop_price))\n    if not is_stop_hit:\n        continue\n\n    # \u30b9\u30c8\u30c3\u30d7\u4fa1\u683c\u306b\u9054\u3059\u308b\u3068\u3001\u30b9\u30c8\u30c3\u30d7\u6ce8\u6587\u306f\u6210\u884c/\u6307\u5024\u6ce8\u6587\u306b\u306a\u308b\n    order._replace(stop_price=None)\n</code></pre>"},{"location":"execution-logic-report/#_5","title":"\u7d04\u5b9a\u4fa1\u683c\u6c7a\u5b9a\u30eb\u30fc\u30eb\uff1a","text":"<ol> <li>\u30ed\u30f3\u30b0\u30dd\u30b8\u30b7\u30e7\u30f3\uff1a</li> <li>\u7d04\u5b9a\u6761\u4ef6\uff1a<code>High &gt;= stop_price</code></li> <li> <p>\u30b9\u30c8\u30c3\u30d7\u4fa1\u683c\u306b\u9054\u3057\u305f\u5f8c\u306f\u6210\u884c\u6ce8\u6587\u3068\u3057\u3066\u51e6\u7406</p> </li> <li> <p>\u30b7\u30e7\u30fc\u30c8\u30dd\u30b8\u30b7\u30e7\u30f3\uff1a</p> </li> <li>\u7d04\u5b9a\u6761\u4ef6\uff1a<code>Low &lt;= stop_price</code></li> <li>\u30b9\u30c8\u30c3\u30d7\u4fa1\u683c\u306b\u9054\u3057\u305f\u5f8c\u306f\u6210\u884c\u6ce8\u6587\u3068\u3057\u3066\u51e6\u7406</li> </ol>"},{"location":"execution-logic-report/#4","title":"4. \u30b9\u30c8\u30c3\u30d7\u30ed\u30b9/\u30c6\u30a4\u30af\u30d7\u30ed\u30d5\u30a3\u30c3\u30c8\u6ce8\u6587\u306e\u7d04\u5b9a\u4fa1\u683c","text":"<p>\u6761\u4ef6\u4ed8\u304d\u6ce8\u6587\uff08SL/TP\uff09\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u51e6\u7406\u3055\u308c\u307e\u3059\uff1a</p> <pre><code># \u6761\u4ef6\u4ed8\u304d\u6ce8\u6587\u306f\u5e38\u306b\u6b21\u306e\u59cb\u5024\u3067\nprev_close = df.Close.iloc[-2]\nprice = prev_close if self._trade_on_close and not order.is_contingent else open\n</code></pre>"},{"location":"execution-logic-report/#_6","title":"\u7d04\u5b9a\u4fa1\u683c\u6c7a\u5b9a\u30eb\u30fc\u30eb\uff1a","text":"<ul> <li>\u5e38\u306bOpen\uff08\u59cb\u5024\uff09\u3067\u7d04\u5b9a</li> <li><code>trade_on_close</code>\u306e\u8a2d\u5b9a\u306b\u95a2\u4fc2\u306a\u304f</li> </ul>"},{"location":"execution-logic-report/#_7","title":"\u30b9\u30d7\u30ec\u30c3\u30c9\u3068\u624b\u6570\u6599\u306e\u9069\u7528","text":"<p>\u7d04\u5b9a\u4fa1\u683c\u306f\u3001\u30b9\u30d7\u30ec\u30c3\u30c9\u3068\u624b\u6570\u6599\u3092\u8003\u616e\u3057\u3066\u8abf\u6574\u3055\u308c\u307e\u3059\uff1a</p> <pre><code>def _adjusted_price(self, code: str, size=None, price=None) -&gt; float:\n    \"\"\"\n    Long/short `price`, adjusted for spread.\n    In long positions, the adjusted price is a fraction higher, and vice versa.\n    \"\"\"\n    return (price or self.last_price(code)) * (1 + copysign(self._spread, size))\n</code></pre>"},{"location":"execution-logic-report/#_8","title":"\u8abf\u6574\u30ed\u30b8\u30c3\u30af\uff1a","text":"<ol> <li>\u30ed\u30f3\u30b0\u30dd\u30b8\u30b7\u30e7\u30f3\uff1a</li> <li>\u8abf\u6574\u4fa1\u683c = \u7d04\u5b9a\u4fa1\u683c \u00d7 (1 + spread)</li> <li> <p>\u3088\u308a\u9ad8\u3044\u4fa1\u683c\u3067\u8cfc\u5165\uff08\u4e0d\u5229\uff09</p> </li> <li> <p>\u30b7\u30e7\u30fc\u30c8\u30dd\u30b8\u30b7\u30e7\u30f3\uff1a</p> </li> <li>\u8abf\u6574\u4fa1\u683c = \u7d04\u5b9a\u4fa1\u683c \u00d7 (1 - spread)</li> <li>\u3088\u308a\u4f4e\u3044\u4fa1\u683c\u3067\u58f2\u5374\uff08\u4e0d\u5229\uff09</li> </ol>"},{"location":"execution-logic-report/#_9","title":"\u5b9f\u969b\u306e\u7d04\u5b9a\u4fa1\u683c\u306e\u6c7a\u5b9a\u30d5\u30ed\u30fc","text":""},{"location":"execution-logic-report/#1","title":"1. \u57fa\u672c\u7684\u306a\u7d04\u5b9a\u4fa1\u683c\u306e\u6c7a\u5b9a","text":"<pre><code># \u57fa\u672c\u7684\u306a\u7d04\u5b9a\u4fa1\u683c\nif order.limit:\n    # \u6307\u5024\u6ce8\u6587\u306e\u5834\u5408\n    price = (min(stop_price or open, order.limit) if order.is_long else\n             max(stop_price or open, order.limit))\nelse:\n    # \u6210\u884c\u6ce8\u6587\u306e\u5834\u5408\n    prev_close = df.Close.iloc[-2]\n    price = prev_close if self._trade_on_close and not order.is_contingent else open\n</code></pre>"},{"location":"execution-logic-report/#2","title":"2. \u30b9\u30d7\u30ec\u30c3\u30c9\u8abf\u6574","text":"<pre><code># \u30b9\u30d7\u30ec\u30c3\u30c9\u8abf\u6574\nadjusted_price = self._adjusted_price(code=order.code, size=order.size, price=price)\n</code></pre>"},{"location":"execution-logic-report/#3","title":"3. \u624b\u6570\u6599\u8a08\u7b97","text":"<pre><code># \u624b\u6570\u6599\u8a08\u7b97\nadjusted_price_plus_commission = \\\n    adjusted_price + self._commission(order.size, price) / abs(order.size)\n</code></pre>"},{"location":"execution-logic-report/#_10","title":"\u7d04\u5b9a\u4fa1\u683c\u306e\u512a\u5148\u9806\u4f4d","text":""},{"location":"execution-logic-report/#1_1","title":"1. \u6307\u5024\u6ce8\u6587\u306e\u5834\u5408","text":"<ol> <li>\u30b9\u30c8\u30c3\u30d7\u4fa1\u683c\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\uff1a</li> <li>\u30ed\u30f3\u30b0\uff1a<code>min(\u59cb\u5024, \u6307\u5024\u4fa1\u683c)</code></li> <li> <p>\u30b7\u30e7\u30fc\u30c8\uff1a<code>max(\u59cb\u5024, \u6307\u5024\u4fa1\u683c)</code></p> </li> <li> <p>\u30b9\u30c8\u30c3\u30d7\u4fa1\u683c\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\uff1a</p> </li> <li>\u30ed\u30f3\u30b0\uff1a<code>min(\u59cb\u5024, \u6307\u5024\u4fa1\u683c)</code></li> <li>\u30b7\u30e7\u30fc\u30c8\uff1a<code>max(\u59cb\u5024, \u6307\u5024\u4fa1\u683c)</code></li> </ol>"},{"location":"execution-logic-report/#2_1","title":"2. \u6210\u884c\u6ce8\u6587\u306e\u5834\u5408","text":"<ol> <li><code>trade_on_close=True</code>\u304b\u3064\u6761\u4ef6\u4ed8\u304d\u6ce8\u6587\u3067\u306a\u3044\u5834\u5408\uff1a</li> <li> <p>\u7d04\u5b9a\u4fa1\u683c = \u524d\u306e\u30d0\u30fc\u306e\u7d42\u5024\uff08Close\uff09</p> </li> <li> <p>\u305d\u306e\u4ed6\u306e\u5834\u5408\uff1a</p> </li> <li>\u7d04\u5b9a\u4fa1\u683c = \u73fe\u5728\u306e\u30d0\u30fc\u306e\u59cb\u5024\uff08Open\uff09</li> </ol>"},{"location":"execution-logic-report/#_11","title":"\u91cd\u8981\u306a\u6ce8\u610f\u70b9","text":""},{"location":"execution-logic-report/#1_2","title":"1. \u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u65b9\u6cd5","text":"<pre><code>open, high, low = df.Open.iloc[-1], df.High.iloc[-1], df.Low.iloc[-1]\n</code></pre> <ul> <li><code>iloc[-1]</code>\uff1a\u73fe\u5728\u306e\u30d0\u30fc\uff08\u6700\u65b0\u306e\u30ed\u30fc\u30bd\u30af\u8db3\uff09</li> <li><code>iloc[-2]</code>\uff1a\u524d\u306e\u30d0\u30fc\uff081\u3064\u524d\u306e\u30ed\u30fc\u30bd\u30af\u8db3\uff09</li> </ul>"},{"location":"execution-logic-report/#2_2","title":"2. \u6761\u4ef6\u4ed8\u304d\u6ce8\u6587\u306e\u7279\u5225\u6271\u3044","text":"<pre><code># \u6761\u4ef6\u4ed8\u304d\u6ce8\u6587\u306f\u5e38\u306b\u6b21\u306e\u59cb\u5024\u3067\nprice = prev_close if self._trade_on_close and not order.is_contingent else open\n</code></pre> <p>\u6761\u4ef6\u4ed8\u304d\u6ce8\u6587\uff08SL/TP\uff09\u306f<code>trade_on_close</code>\u306e\u8a2d\u5b9a\u306b\u95a2\u4fc2\u306a\u304f\u3001\u5e38\u306b**Open**\u3067\u7d04\u5b9a\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"execution-logic-report/#3_1","title":"3. \u30b9\u30c8\u30c3\u30d7\u6ce8\u6587\u306e\u5909\u63db","text":"<p>\u30b9\u30c8\u30c3\u30d7\u4fa1\u683c\u306b\u9054\u3059\u308b\u3068\u3001\u30b9\u30c8\u30c3\u30d7\u6ce8\u6587\u306f\u81ea\u52d5\u7684\u306b\u6210\u884c\u6ce8\u6587\u306b\u5909\u63db\u3055\u308c\u307e\u3059\uff1a</p> <pre><code># \u30b9\u30c8\u30c3\u30d7\u4fa1\u683c\u306b\u9054\u3059\u308b\u3068\u3001\u30b9\u30c8\u30c3\u30d7\u6ce8\u6587\u306f\u6210\u884c/\u6307\u5024\u6ce8\u6587\u306b\u306a\u308b\norder._replace(stop_price=None)\n</code></pre>"},{"location":"execution-logic-report/#_12","title":"\u307e\u3068\u3081","text":"<p>BackcastPro\u306b\u304a\u3051\u308b\u7d04\u5b9a\u4fa1\u683c\u306e\u6c7a\u5b9a\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8981\u7d04\u3055\u308c\u307e\u3059\uff1a</p> <ol> <li>\u6210\u884c\u6ce8\u6587\uff1a</li> <li>\u30c7\u30d5\u30a9\u30eb\u30c8\uff1aOpen\uff08\u59cb\u5024\uff09</li> <li> <p><code>trade_on_close=True</code>\uff1aClose\uff08\u524d\u306e\u30d0\u30fc\u306e\u7d42\u5024\uff09</p> </li> <li> <p>\u6307\u5024\u6ce8\u6587\uff1a</p> </li> <li>\u30ed\u30f3\u30b0\uff1a<code>min(\u59cb\u5024, \u6307\u5024\u4fa1\u683c)</code></li> <li> <p>\u30b7\u30e7\u30fc\u30c8\uff1a<code>max(\u59cb\u5024, \u6307\u5024\u4fa1\u683c)</code></p> </li> <li> <p>\u30b9\u30c8\u30c3\u30d7\u6ce8\u6587\uff1a</p> </li> <li> <p>\u6761\u4ef6\u9054\u6210\u5f8c\u306f\u6210\u884c\u6ce8\u6587\u3068\u3057\u3066\u51e6\u7406</p> </li> <li> <p>\u6761\u4ef6\u4ed8\u304d\u6ce8\u6587\uff08SL/TP\uff09\uff1a</p> </li> <li> <p>\u5e38\u306b**Open**\uff08\u59cb\u5024\uff09</p> </li> <li> <p>\u30b9\u30d7\u30ec\u30c3\u30c9\u8abf\u6574\uff1a</p> </li> <li>\u30ed\u30f3\u30b0\uff1a\u7d04\u5b9a\u4fa1\u683c \u00d7 (1 + spread)</li> <li>\u30b7\u30e7\u30fc\u30c8\uff1a\u7d04\u5b9a\u4fa1\u683c \u00d7 (1 - spread)</li> </ol> <p>\u3053\u306e\u30ed\u30b8\u30c3\u30af\u306b\u3088\u308a\u3001\u30ea\u30a2\u30eb\u306a\u53d6\u5f15\u74b0\u5883\u3092\u30b7\u30df\u30e5\u30ec\u30fc\u30c8\u3057\u3001\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u306e\u7cbe\u5ea6\u3092\u5411\u4e0a\u3055\u305b\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"how-to-deploy-to-PyPI/","title":"PyPI\u30c7\u30d7\u30ed\u30a4","text":""},{"location":"how-to-deploy-to-PyPI/#pypiwindows-uv","title":"PyPI\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u65b9\u6cd5\uff08Windows / uv\uff09","text":"<p>\u8a73\u7d30\u306a\u30ea\u30ea\u30fc\u30b9\u624b\u9806\u306f <code>developer-guide.md</code> \u306e\u300c\u30ea\u30ea\u30fc\u30b9\u30d7\u30ed\u30bb\u30b9\u300d\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u3053\u3067\u306f\u6700\u5c0f\u624b\u9806\u306e\u307f\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002</p>"},{"location":"how-to-deploy-to-PyPI/#1","title":"1. \u914d\u5e03\u7269\u3092\u30d3\u30eb\u30c9","text":"<pre><code>uv build\n</code></pre>"},{"location":"how-to-deploy-to-PyPI/#2-pypi","title":"2. PyPI\u3078\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9","text":"<pre><code>uv publish\n</code></pre> <pre><code>uv publish --publish-url https://test.pypi.org/legacy/\n</code></pre> <p>\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u6642\u306f PyPI \u306e API \u30c8\u30fc\u30af\u30f3\uff08<code>pypi-</code> \u3067\u59cb\u307e\u308b\u5024\uff09\u3092\u5165\u529b\u3057\u307e\u3059\u3002</p> <p>\u74b0\u5883\u5909\u6570\u3067\u4e8b\u524d\u306b\u8a2d\u5b9a\u3059\u308b\u5834\u5408\uff1a</p> <pre><code>$env:UV_PUBLISH_TOKEN = \"pypi-xxxx...\"\nuv publish\n</code></pre> <p>\u53c2\u8003: - uv build - uv publish - Packaging projects\uff08\u516c\u5f0f\uff09</p>"},{"location":"privacy/","title":"\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u30dd\u30ea\u30b7\u30fc","text":"<p>BackcastPro\uff08\u4ee5\u4e0b\u3001\u300c\u5f53\u793e\u300d\u3068\u3044\u3044\u307e\u3059\u3002\uff09\u306f\u3001\u5f53\u793e\u304c\u63d0\u4f9b\u3059\u308b\u30b5\u30fc\u30d3\u30b9\uff08\u4ee5\u4e0b\u3001\u300c\u672c\u30b5\u30fc\u30d3\u30b9\u300d\u3068\u3044\u3044\u307e\u3059\u3002\uff09\u306b\u304a\u3044\u3066\u53d6\u5f97\u3059\u308b\u5229\u7528\u8005\u306e\u500b\u4eba\u60c5\u5831\u7b49\u306b\u3064\u3044\u3066\u3001\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u30dd\u30ea\u30b7\u30fc\uff08\u4ee5\u4e0b\u3001\u300c\u672c\u30dd\u30ea\u30b7\u30fc\u300d\u3068\u3044\u3044\u307e\u3059\u3002\uff09\u3092\u5b9a\u3081\u307e\u3059\u3002</p>"},{"location":"privacy/#1","title":"1. \u53d6\u5f97\u3059\u308b\u60c5\u5831","text":"<ul> <li>\u5f53\u793e\u304c\u5b9a\u3081\u308b\u30d5\u30a9\u30fc\u30e0\u7b49\u3092\u901a\u3058\u3066\u5229\u7528\u8005\u304b\u3089\u3054\u63d0\u4f9b\u3044\u305f\u3060\u304f\u6c0f\u540d\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3001\u6240\u5c5e\u3001\u305d\u306e\u4ed6\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9\u306b\u542b\u307e\u308c\u308b\u60c5\u5831</li> <li>\u30b5\u30fc\u30d3\u30b9\u5229\u7528\u6642\u306b\u81ea\u52d5\u53d6\u5f97\u3059\u308b\u30ed\u30b0\u60c5\u5831\u3001\u7aef\u672b\u60c5\u5831\u3001Cookie \u53ca\u3073\u985e\u4f3c\u6280\u8853\u3092\u7528\u3044\u3066\u53d6\u5f97\u3059\u308b\u60c5\u5831</li> <li>\u5229\u7528\u8005\u304b\u3089\u500b\u5225\u306b\u540c\u610f\u3092\u3044\u305f\u3060\u3044\u305f\u4e0a\u3067\u53d6\u5f97\u3059\u308b\u305d\u306e\u4ed6\u306e\u60c5\u5831</li> </ul>"},{"location":"privacy/#2","title":"2. \u5229\u7528\u76ee\u7684","text":"<p>\u5f53\u793e\u306f\u53d6\u5f97\u3057\u305f\u60c5\u5831\u3092\u3001\u4ee5\u4e0b\u306e\u76ee\u7684\u306e\u305f\u3081\u306b\u5229\u7528\u3057\u307e\u3059\u3002 - \u672c\u30b5\u30fc\u30d3\u30b9\u306b\u95a2\u3059\u308b\u767b\u9332\u3001\u672c\u4eba\u78ba\u8a8d\u3001\u5229\u7528\u8005\u7ba1\u7406\u306e\u305f\u3081 - \u672c\u30b5\u30fc\u30d3\u30b9\u306e\u63d0\u4f9b\u3001\u7dad\u6301\u3001\u4fdd\u8b77\u53ca\u3073\u6539\u5584\u306e\u305f\u3081 - \u5229\u7528\u8005\u304b\u3089\u306e\u304a\u554f\u3044\u5408\u308f\u305b\u3078\u306e\u5bfe\u5fdc\u53ca\u3073\u5fc5\u8981\u306b\u5fdc\u3058\u305f\u9023\u7d61\u306e\u305f\u3081 - \u5f53\u793e\u304c\u63d0\u4f9b\u3059\u308b\u30b5\u30fc\u30d3\u30b9\u7b49\u306b\u95a2\u3059\u308b\u3054\u6848\u5185\u3001\u30ad\u30e3\u30f3\u30da\u30fc\u30f3\u3001\u30a2\u30f3\u30b1\u30fc\u30c8\u306e\u5b9f\u65bd\u306e\u305f\u3081 - \u4e0d\u6b63\u5229\u7528\u9632\u6b62\u3084\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5411\u4e0a\u3001\u30c8\u30e9\u30d6\u30eb\u5bfe\u5fdc\u306e\u305f\u3081 - \u6cd5\u4ee4\u53c8\u306f\u884c\u653f\u6a5f\u95a2\u306e\u8981\u8acb\u306b\u57fa\u3065\u304f\u5bfe\u5fdc\u306e\u305f\u3081</p>"},{"location":"privacy/#3","title":"3. \u7b2c\u4e09\u8005\u63d0\u4f9b","text":"<p>\u5f53\u793e\u306f\u3001\u4ee5\u4e0b\u306e\u5834\u5408\u3092\u9664\u304d\u3001\u53d6\u5f97\u3057\u305f\u500b\u4eba\u60c5\u5831\u3092\u7b2c\u4e09\u8005\u306b\u63d0\u4f9b\u3057\u307e\u305b\u3093\u3002 - \u5229\u7528\u8005\u3054\u672c\u4eba\u306e\u540c\u610f\u304c\u3042\u308b\u5834\u5408 - \u6cd5\u4ee4\u306b\u57fa\u3065\u304f\u5834\u5408 - \u4eba\u306e\u751f\u547d\u3001\u8eab\u4f53\u53c8\u306f\u8ca1\u7523\u306e\u4fdd\u8b77\u306e\u305f\u3081\u306b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u3067\u3042\u3063\u3066\u3001\u5229\u7528\u8005\u3054\u672c\u4eba\u306e\u540c\u610f\u3092\u5f97\u308b\u3053\u3068\u304c\u56f0\u96e3\u3067\u3042\u308b\u3068\u304d - \u516c\u8846\u885b\u751f\u306e\u5411\u4e0a\u53c8\u306f\u5150\u7ae5\u306e\u5065\u5168\u306a\u80b2\u6210\u306e\u63a8\u9032\u306e\u305f\u3081\u306b\u7279\u306b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u3067\u3042\u3063\u3066\u3001\u5229\u7528\u8005\u3054\u672c\u4eba\u306e\u540c\u610f\u3092\u5f97\u308b\u3053\u3068\u304c\u56f0\u96e3\u3067\u3042\u308b\u3068\u304d - \u56fd\u306e\u6a5f\u95a2\u3001\u5730\u65b9\u516c\u5171\u56e3\u4f53\u53c8\u306f\u305d\u306e\u59d4\u8a17\u3092\u53d7\u3051\u305f\u8005\u304c\u6cd5\u4ee4\u306e\u5b9a\u3081\u308b\u4e8b\u52d9\u3092\u9042\u884c\u3059\u308b\u3053\u3068\u306b\u5bfe\u3057\u3066\u5354\u529b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u3067\u3042\u3063\u3066\u3001\u5229\u7528\u8005\u3054\u672c\u4eba\u306e\u540c\u610f\u3092\u5f97\u308b\u3053\u3068\u306b\u3088\u308a\u5f53\u8a72\u4e8b\u52d9\u306e\u9042\u884c\u306b\u652f\u969c\u3092\u53ca\u307c\u3059\u304a\u305d\u308c\u304c\u3042\u308b\u3068\u304d</p>"},{"location":"privacy/#4","title":"4. \u59d4\u8a17\u5148\u306e\u7ba1\u7406","text":"<p>\u5f53\u793e\u306f\u3001\u696d\u52d9\u59d4\u8a17\u5148\u306b\u500b\u4eba\u60c5\u5831\u306e\u53d6\u6271\u3044\u3092\u59d4\u8a17\u3059\u308b\u5834\u5408\u306b\u306f\u3001\u9069\u5207\u306a\u5951\u7d04\u53ca\u3073\u76e3\u7763\u3092\u884c\u3044\u3001\u59d4\u8a17\u5148\u306b\u672c\u30dd\u30ea\u30b7\u30fc\u3068\u540c\u7b49\u4ee5\u4e0a\u306e\u5b89\u5168\u7ba1\u7406\u304c\u56f3\u3089\u308c\u308b\u3088\u3046\u52aa\u3081\u307e\u3059\u3002</p>"},{"location":"privacy/#5","title":"5. \u500b\u4eba\u60c5\u5831\u306e\u5b89\u5168\u7ba1\u7406","text":"<p>\u5f53\u793e\u306f\u3001\u500b\u4eba\u60c5\u5831\u306e\u6f0f\u3048\u3044\u3001\u6ec5\u5931\u53c8\u306f\u304d\u640d\u3092\u9632\u6b62\u3059\u308b\u305f\u3081\u3001\u5fc5\u8981\u304b\u3064\u9069\u5207\u306a\u5b89\u5168\u7ba1\u7406\u63aa\u7f6e\u3092\u8b1b\u3058\u308b\u3068\u3068\u3082\u306b\u3001\u5f93\u696d\u54e1\u53ca\u3073\u59d4\u8a17\u5148\u306b\u5bfe\u3057\u3066\u5fc5\u8981\u306a\u6559\u80b2\u30fb\u76e3\u7763\u3092\u884c\u3044\u307e\u3059\u3002</p>"},{"location":"privacy/#6","title":"6. \u500b\u4eba\u60c5\u5831\u306b\u95a2\u3059\u308b\u6a29\u5229","text":"<p>\u5229\u7528\u8005\u306f\u3001\u5f53\u793e\u304c\u4fdd\u6709\u3059\u308b\u81ea\u5df1\u306e\u500b\u4eba\u60c5\u5831\u306b\u3064\u3044\u3066\u3001\u958b\u793a\u3001\u8a02\u6b63\u3001\u5229\u7528\u505c\u6b62\u3001\u524a\u9664\u7b49\u306e\u8acb\u6c42\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u8acb\u6c42\u3092\u884c\u3046\u5834\u5408\u306f\u3001\u7b2c9\u6761\u306e\u304a\u554f\u3044\u5408\u308f\u305b\u7a93\u53e3\u307e\u3067\u3054\u9023\u7d61\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"privacy/#7","title":"7. \u672a\u6210\u5e74\u8005\u306e\u500b\u4eba\u60c5\u5831","text":"<p>\u672a\u6210\u5e74\u8005\u304c\u672c\u30b5\u30fc\u30d3\u30b9\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u4fdd\u8b77\u8005\u306e\u540c\u610f\u3092\u5f97\u305f\u4e0a\u3067\u3054\u5229\u7528\u304f\u3060\u3055\u3044\u3002\u4fdd\u8b77\u8005\u306e\u540c\u610f\u304c\u306a\u3044\u5834\u5408\u3001\u5f53\u793e\u306f\u500b\u4eba\u60c5\u5831\u306e\u53d6\u5f97\u53c8\u306f\u5229\u7528\u3092\u4e2d\u6b62\u3059\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002</p>"},{"location":"privacy/#8","title":"8. \u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u30dd\u30ea\u30b7\u30fc\u306e\u6539\u5b9a","text":"<p>\u5f53\u793e\u306f\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u672c\u30dd\u30ea\u30b7\u30fc\u306e\u5185\u5bb9\u3092\u6539\u5b9a\u3059\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\u91cd\u8981\u306a\u5909\u66f4\u304c\u3042\u308b\u5834\u5408\u306b\u306f\u3001\u672c\u30b5\u30fc\u30d3\u30b9\u4e0a\u3067\u544a\u77e5\u3059\u308b\u304b\u3001\u5229\u7528\u8005\u306b\u901a\u77e5\u3057\u307e\u3059\u3002</p>"},{"location":"privacy/#9","title":"9. \u304a\u554f\u3044\u5408\u308f\u305b\u7a93\u53e3","text":"<p>\u672c\u30dd\u30ea\u30b7\u30fc\u306b\u95a2\u3059\u308b\u304a\u554f\u3044\u5408\u308f\u305b\u306f\u3001\u4e0b\u8a18\u7a93\u53e3\u307e\u3067\u3054\u9023\u7d61\u304f\u3060\u3055\u3044\u3002</p> <ul> <li>\u9023\u7d61\u5148\uff1aprivacy@backcastpro.example</li> <li>\u6240\u5728\u5730\uff1a\u3012000-0000 \u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u30b5\u30f3\u30d7\u30eb1-2-3 BackcastPro\u5185</li> </ul>"},{"location":"privacy/#10","title":"10. \u5236\u5b9a\u30fb\u6539\u5b9a\u65e5","text":"<ul> <li>\u5236\u5b9a\u65e5\uff1a2025\u5e7411\u670810\u65e5</li> <li>\u6700\u7d42\u6539\u5b9a\u65e5\uff1a2025\u5e7411\u670810\u65e5</li> </ul>"},{"location":"troubleshooting/","title":"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u30ac\u30a4\u30c9","text":"<p>BackcastPro\u3092\u4f7f\u7528\u3059\u308b\u969b\u306b\u3088\u304f\u767a\u751f\u3059\u308b\u554f\u984c\u3068\u305d\u306e\u89e3\u6c7a\u65b9\u6cd5\u3092\u307e\u3068\u3081\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"troubleshooting/#_2","title":"\u76ee\u6b21","text":"<ul> <li>\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u95a2\u9023\u306e\u554f\u984c</li> <li>\u30c7\u30fc\u30bf\u95a2\u9023\u306e\u554f\u984c</li> <li>\u6226\u7565\u5b9f\u88c5\u306e\u554f\u984c</li> <li>\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u5b9f\u884c\u306e\u554f\u984c</li> <li>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u554f\u984c</li> <li>\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u4e00\u89a7</li> </ul>"},{"location":"troubleshooting/#_3","title":"\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u95a2\u9023\u306e\u554f\u984c","text":""},{"location":"troubleshooting/#modulenotfounderror-no-module-named-backcastpro","title":"\u554f\u984c: <code>ModuleNotFoundError: No module named 'BackcastPro'</code>","text":"<p>\u539f\u56e0: BackcastPro\u304c\u6b63\u3057\u304f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u3044</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># PyPI\u304b\u3089\u518d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npython -m pip install BackcastPro\n\n# \u307e\u305f\u306f\u958b\u767a\u7528\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ngit clone &lt;repository-url&gt;\ncd BackcastPro\npython -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npython -m pip install -e .\n</code></pre></p>"},{"location":"troubleshooting/#importerror-cannot-import-name-strategy","title":"\u554f\u984c: <code>ImportError: cannot import name 'Strategy'</code>","text":"<p>\u539f\u56e0: \u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3001\u307e\u305f\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u4e0d\u5b8c\u5168</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># \u65e2\u5b58\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npython -m pip uninstall BackcastPro -y\n\n# \u6700\u65b0\u7248\u3092\u518d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npython -m pip install BackcastPro\n</code></pre></p>"},{"location":"troubleshooting/#_4","title":"\u554f\u984c: \u4f9d\u5b58\u95a2\u4fc2\u306e\u7af6\u5408","text":"<p>\u539f\u56e0: \u4ed6\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u306e\u4f9d\u5b58\u95a2\u4fc2\u306e\u7af6\u5408</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># \u4eee\u60f3\u74b0\u5883\u3092\u4f5c\u6210\uff08Windows\uff09\npython -m venv backcastpro_env\n.\\backcastpro_env\\Scripts\\Activate.ps1\n\n# \u30af\u30ea\u30fc\u30f3\u306a\u74b0\u5883\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npython -m pip install BackcastPro\n</code></pre></p>"},{"location":"troubleshooting/#_5","title":"\u30c7\u30fc\u30bf\u95a2\u9023\u306e\u554f\u984c","text":""},{"location":"troubleshooting/#valueerror-data-must-be-a-pandasdataframe-with-columns","title":"\u554f\u984c: <code>ValueError: data must be a pandas.DataFrame with columns</code>","text":"<p>\u539f\u56e0: \u30c7\u30fc\u30bf\u304c\u8f9e\u66f8\u5f62\u5f0f\u3067\u306a\u3044\u3001\u307e\u305f\u306fDataFrame\u3067\u306a\u3044</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># \u6b63\u3057\u3044\u5f62\u5f0f: \u8f9e\u66f8\u3067\u9298\u67c4\u30b3\u30fc\u30c9\u3092\u30ad\u30fc\u3068\u3057\u3066DataFrame\u3092\u6e21\u3059\ndata = {\n    '7203.JP': toyota_data,\n    '6758.JP': sony_data\n}\nbt = Backtest(data, MyStrategy)\n\n# \u5358\u4e00\u9298\u67c4\u306e\u5834\u5408\u3082\u8f9e\u66f8\u5f62\u5f0f\u3067\u6e21\u3059\nbt = Backtest({'7203.JP': toyota_data}, MyStrategy)\n</code></pre></p>"},{"location":"troubleshooting/#valueerror-data-must-be-a-pandasdataframe-with-columns_1","title":"\u554f\u984c: <code>ValueError: data must be a pandas.DataFrame with columns</code> (\u65e7\u5f62\u5f0f)","text":"<p>\u539f\u56e0: \u30c7\u30fc\u30bf\u304cDataFrame\u3067\u306a\u3044\u3001\u307e\u305f\u306f\u5fc5\u8981\u306a\u5217\u304c\u306a\u3044</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code>import pandas as pd\n\n# \u5fc5\u8981\u306a\u5217\u3092\u78ba\u8a8d\nrequired_columns = ['Open', 'High', 'Low', 'Close']\nif not all(col in data.columns for col in required_columns):\n    print(\"\u4e0d\u8db3\u3057\u3066\u3044\u308b\u5217:\", [col for col in required_columns if col not in data.columns])\n    # \u4e0d\u8db3\u3057\u3066\u3044\u308b\u5217\u3092\u8ffd\u52a0\n    for col in required_columns:\n        if col not in data.columns:\n            data[col] = data['Close']  # \u7d42\u5024\u3067\u88dc\u5b8c\n</code></pre></p>"},{"location":"troubleshooting/#valueerror-some-ohlc-values-are-missing-nan","title":"\u554f\u984c: <code>ValueError: Some OHLC values are missing (NaN)</code>","text":"<p>\u539f\u56e0: OHLC\u30c7\u30fc\u30bf\u306b\u6b20\u640d\u5024\u304c\u3042\u308b</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># \u6b20\u640d\u5024\u3092\u78ba\u8a8d\nprint(data.isnull().sum())\n\n# \u6b20\u640d\u5024\u3092\u524a\u9664\ndata = data.dropna()\n\n# \u307e\u305f\u306f\u88dc\u9593\ndata = data.interpolate()\n\n# \u307e\u305f\u306f\u524d\u306e\u5024\u3067\u57cb\u3081\u308b\ndata = data.fillna(method='ffill')\n</code></pre></p>"},{"location":"troubleshooting/#requestsrequestexception-failed-to-fetch-data-from-api","title":"\u554f\u984c: <code>requests.RequestException: Failed to fetch data from API</code>","text":"<p>\u539f\u56e0: API\u63a5\u7d9a\u306e\u554f\u984c</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># 1. \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u3092\u78ba\u8a8d\nimport requests\ntry:\n    response = requests.get('https://httpbin.org/get', timeout=5)\n    print(\"\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a: OK\")\nexcept:\n    print(\"\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a: NG\")\n\n# 2. \u74b0\u5883\u5909\u6570\u3092\u78ba\u8a8d\nimport os\nprint(\"API URL:\", os.getenv('BACKCASTPRO_API_URL'))\n\n# 3. \u624b\u52d5\u3067\u30c7\u30fc\u30bf\u3092\u8a2d\u5b9a\ncustom_data = pd.DataFrame({\n    'Open': [100, 101, 102],\n    'High': [105, 106, 107],\n    'Low': [99, 100, 101],\n    'Close': [104, 105, 106],\n    'Volume': [1000, 1100, 1200]\n}, index=pd.date_range('2023-01-01', periods=3))\n</code></pre></p>"},{"location":"troubleshooting/#_6","title":"\u554f\u984c: \u30c7\u30fc\u30bf\u304c\u7a7a\u307e\u305f\u306f\u53d6\u5f97\u3067\u304d\u306a\u3044","text":"<p>\u539f\u56e0: \u9298\u67c4\u30b3\u30fc\u30c9\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u3001\u307e\u305f\u306f\u671f\u9593\u304c\u7121\u52b9</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code>import yfinance as yf\n\n# 1. \u671f\u9593\u3092\u78ba\u8a8d\nfrom datetime import datetime, timedelta\nend_date = datetime.now()\nstart_date = end_date - timedelta(days=365)\nprint(f\"\u671f\u9593: {start_date} \u304b\u3089 {end_date}\")\n\n# 2. \u7570\u306a\u308b\u9298\u67c4\u3067\u8a66\u3059\ndata = yf.download('7203.T', period='1y')  # \u30c8\u30e8\u30bf\nif data is None or len(data) == 0:\n    print(\"\u30c7\u30fc\u30bf\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\")\n</code></pre></p>"},{"location":"troubleshooting/#_7","title":"\u6226\u7565\u5b9f\u88c5\u306e\u554f\u984c","text":""},{"location":"troubleshooting/#typeerror-strategy-must-be-a-strategy-sub-type","title":"\u554f\u984c: <code>TypeError: strategy must be a Strategy sub-type</code>","text":"<p>\u539f\u56e0: \u6226\u7565\u30af\u30e9\u30b9\u304cStrategy\u3092\u7d99\u627f\u3057\u3066\u3044\u306a\u3044</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code>from BackcastPro import Strategy\n\n# \u6b63\u3057\u3044\u5b9f\u88c5\nclass MyStrategy(Strategy):  # Strategy\u3092\u7d99\u627f\n    def init(self):\n        pass\n\n    def next(self):\n        pass\n\n# \u9593\u9055\u3063\u305f\u5b9f\u88c5\nclass WrongStrategy:  # Strategy\u3092\u7d99\u627f\u3057\u3066\u3044\u306a\u3044\n    def init(self):\n        pass\n\n    def next(self):\n        pass\n</code></pre></p>"},{"location":"troubleshooting/#attributeerror-mystrategy-object-has-no-attribute-data","title":"\u554f\u984c: <code>AttributeError: 'MyStrategy' object has no attribute 'data'</code>","text":"<p>\u539f\u56e0: <code>init()</code>\u30e1\u30bd\u30c3\u30c9\u3067<code>self.data</code>\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3044\u308b</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code>class MyStrategy(Strategy):\n    def init(self):\n        # \u6b63\u3057\u3044: self.data\u3092\u4f7f\u7528\n        for code, df in self.data.items():\n            df['SMA'] = df.Close.rolling(20).mean()\n\n    def next(self):\n        # \u6b63\u3057\u3044: self.data\u3092\u4f7f\u7528\n        for code, df in self.data.items():\n            if df.SMA.iloc[-1] &gt; df.Close.iloc[-1]:\n                self.buy(code=code)\n</code></pre></p>"},{"location":"troubleshooting/#_8","title":"\u554f\u984c: \u6226\u7565\u304c\u52d5\u4f5c\u3057\u306a\u3044","text":"<p>\u539f\u56e0: \u30ed\u30b8\u30c3\u30af\u30a8\u30e9\u30fc\u307e\u305f\u306f\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u306e\u554f\u984c</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code>class DebugStrategy(Strategy):\n    def init(self):\n        print(\"\u6226\u7565\u521d\u671f\u5316\u5b8c\u4e86\")\n        print(\"\u30c7\u30fc\u30bf\u5f62\u72b6:\", self.data.shape)\n        print(\"\u30c7\u30fc\u30bf\u5217:\", self.data.columns.tolist())\n\n    def next(self):\n        for code, df in self.data.items():\n            print(f\"\u73fe\u5728\u306e\u30d0\u30fc: {len(df)}\")\n            print(f\"\u73fe\u5728\u306e\u7d42\u5024: {df.Close.iloc[-1]}\")\n\n            # \u30c7\u30d0\u30c3\u30b0\u60c5\u5831\u3092\u51fa\u529b\n            if len(df) % 100 == 0:  # 100\u30d0\u30fc\u3054\u3068\u306b\u51fa\u529b\n                print(f\"\u30a8\u30af\u30a4\u30c6\u30a3: {self.equity}\")\n                print(f\"\u30dd\u30b8\u30b7\u30e7\u30f3: {self.position.size}\")\n</code></pre></p>"},{"location":"troubleshooting/#_9","title":"\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u5b9f\u884c\u306e\u554f\u984c","text":""},{"location":"troubleshooting/#valueerror-size","title":"\u554f\u984c: <code>ValueError: size\u306f\u6b63\u306e\u8cc7\u7523\u5272\u5408\u307e\u305f\u306f\u6b63\u306e\u6574\u6570\u5358\u4f4d\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059</code>","text":"<p>\u539f\u56e0: \u53d6\u5f15\u30b5\u30a4\u30ba\u304c\u7121\u52b9</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code>class MyStrategy(Strategy):\n    def next(self):\n        # \u6b63\u3057\u3044: \u8cc7\u7523\u5272\u5408\uff080-1\u306e\u9593\uff09\n        self.buy(size=0.1)  # 10%\u306e\u8cc7\u7523\u3092\u4f7f\u7528\n\n        # \u6b63\u3057\u3044: \u6574\u6570\u5358\u4f4d\n        self.buy(size=100)  # 100\u682a\n\n        # \u9593\u9055\u3063\u305f: \u8ca0\u306e\u5024\n        # self.buy(size=-100)  # \u30a8\u30e9\u30fc\n\n        # \u9593\u9055\u3063\u305f: 1\u3088\u308a\u5927\u304d\u3044\u5272\u5408\n        # self.buy(size=1.5)  # \u30a8\u30e9\u30fc\n</code></pre></p>"},{"location":"troubleshooting/#_10","title":"\u554f\u984c: \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u304c\u7d42\u4e86\u3057\u306a\u3044","text":"<p>\u539f\u56e0: \u7121\u9650\u30eb\u30fc\u30d7\u307e\u305f\u306f\u975e\u5e38\u306b\u9577\u3044\u51e6\u7406\u6642\u9593</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># 1. \u30c7\u30fc\u30bf\u30b5\u30a4\u30ba\u3092\u78ba\u8a8d\nprint(f\"\u30c7\u30fc\u30bf\u30b5\u30a4\u30ba: {len(data)}\")\n\n# 2. \u6226\u7565\u306e\u30ed\u30b8\u30c3\u30af\u3092\u7c21\u7d20\u5316\u3057\u3066\u5207\u308a\u5206\u3051\nclass SimpleStrategy(Strategy):\n    def init(self):\n        pass\n\n    def next(self):\n        for code, df in self.data.items():\n            if len(df) == 1:\n                self.buy(code=code)\n                return\n\n# 3. \u9577\u6642\u9593\u5b9f\u884c\u3092\u907f\u3051\u308b\u305f\u3081\u306b\u30c7\u30fc\u30bf\u671f\u9593\u3092\u77ed\u304f\u3059\u308b\ndata = data.tail(2000)\n\nbt = Backtest({'TEST': data}, SimpleStrategy)\nresults = bt.run()\n</code></pre></p>"},{"location":"troubleshooting/#_11","title":"\u554f\u984c: \u7d50\u679c\u304c\u671f\u5f85\u3068\u7570\u306a\u308b","text":"<p>\u539f\u56e0: \u6226\u7565\u30ed\u30b8\u30c3\u30af\u3001\u30c7\u30fc\u30bf\u3001\u307e\u305f\u306f\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u554f\u984c</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># 1. \u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\nprint(\"\u30c7\u30fc\u30bf\u306e\u6700\u521d\u306e5\u884c:\")\nprint(data.head())\nprint(\"\u30c7\u30fc\u30bf\u306e\u6700\u5f8c\u306e5\u884c:\")\nprint(data.tail())\n\n# 2. \u6226\u7565\u306e\u52d5\u4f5c\u3092\u78ba\u8a8d\nclass LoggingStrategy(Strategy):\n    def init(self):\n        self.trades = []\n\n    def next(self):\n        # \u53d6\u5f15\u30ed\u30b0\u3092\u8a18\u9332\n        for code, df in self.data.items():\n            if len(df) == 1:\n                self.buy(code=code)\n                self.trades.append(('BUY', df.Close.iloc[-1]))\n\n            # \u5b9a\u671f\u7684\u306b\u30ed\u30b0\u3092\u51fa\u529b\n            if len(df) % 100 == 0:\n                print(f\"\u30d0\u30fc {len(df)}: \u30a8\u30af\u30a4\u30c6\u30a3 {self.equity}\")\n\n# 3. \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u78ba\u8a8d\nbt = Backtest({'TEST': data}, LoggingStrategy, cash=10000, commission=0.001)\nprint(\"\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf:\")\nprint(f\"\u521d\u671f\u8cc7\u91d1: {bt._cash}\")\nprint(f\"\u624b\u6570\u6599: {bt._commission}\")\n</code></pre></p>"},{"location":"troubleshooting/#_12","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u554f\u984c","text":""},{"location":"troubleshooting/#_13","title":"\u554f\u984c: \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u304c\u9045\u3044","text":"<p>\u539f\u56e0: \u975e\u52b9\u7387\u306a\u8a08\u7b97\u3084\u5927\u91cf\u306e\u30c7\u30fc\u30bf</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># 1. \u30c7\u30fc\u30bf\u30b5\u30a4\u30ba\u3092\u524a\u6e1b\ndata = data.tail(1000)  # \u6700\u65b01000\u30d0\u30fc\u306e\u307f\u4f7f\u7528\n\n# 2. \u8a08\u7b97\u3092\u6700\u9069\u5316\nclass OptimizedStrategy(Strategy):\n    def init(self):\n        # \u4e8b\u524d\u8a08\u7b97\u3067\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u5411\u4e0a\n        for code, df in self.data.items():\n            df['SMA'] = df.Close.rolling(20).mean()\n            df['RSI'] = calculate_rsi(df)\n\n    def next(self):\n        # \u4e8b\u524d\u8a08\u7b97\u3055\u308c\u305f\u5024\u3092\u53c2\u7167\n        for code, df in self.data.items():\n            if df.SMA.iloc[-1] &gt; df.Close.iloc[-1]:\n                self.buy(code=code)\n\n# 3. \u4e0d\u8981\u306a\u8a08\u7b97\u3092\u524a\u9664\nclass SimpleStrategy(Strategy):\n    def init(self):\n        # \u5fc5\u8981\u6700\u5c0f\u9650\u306e\u8a08\u7b97\u306e\u307f\n        pass\n\n    def next(self):\n        # \u30b7\u30f3\u30d7\u30eb\u306a\u30ed\u30b8\u30c3\u30af\n        for code, df in self.data.items():\n            if len(df) == 1:\n                self.buy(code=code)\n</code></pre></p>"},{"location":"troubleshooting/#_14","title":"\u554f\u984c: \u30e1\u30e2\u30ea\u4f7f\u7528\u91cf\u304c\u5927\u304d\u3044","text":"<p>\u539f\u56e0: \u5927\u91cf\u306e\u30c7\u30fc\u30bf\u307e\u305f\u306f\u975e\u52b9\u7387\u306a\u30c7\u30fc\u30bf\u69cb\u9020</p> <p>\u89e3\u6c7a\u65b9\u6cd5: <pre><code># 1. \u30c7\u30fc\u30bf\u578b\u3092\u6700\u9069\u5316\ndata = data.astype({\n    'Open': 'float32',\n    'High': 'float32',\n    'Low': 'float32',\n    'Close': 'float32',\n    'Volume': 'int32'\n})\n\n# 2. \u4e0d\u8981\u306a\u5217\u3092\u524a\u9664\ndata = data[['Open', 'High', 'Low', 'Close', 'Volume']]\n\n# 3. \u30c7\u30fc\u30bf\u3092\u5206\u5272\u3057\u3066\u51e6\u7406\nchunk_size = 1000\nfor i in range(0, len(data), chunk_size):\n    chunk = data.iloc[i:i+chunk_size]\n    bt = Backtest({'CHUNK': chunk}, MyStrategy)\n    results = bt.run()\n</code></pre></p>"},{"location":"troubleshooting/#_15","title":"\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u4e00\u89a7","text":""},{"location":"troubleshooting/#_16","title":"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3068\u89e3\u6c7a\u65b9\u6cd5","text":"\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8 \u539f\u56e0 \u89e3\u6c7a\u65b9\u6cd5 <code>ModuleNotFoundError: No module named 'BackcastPro'</code> \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u306a\u3044 <code>pip install BackcastPro</code> <code>TypeError: strategy must be a Strategy sub-type</code> \u6226\u7565\u30af\u30e9\u30b9\u304cStrategy\u3092\u7d99\u627f\u3057\u3066\u3044\u306a\u3044 <code>class MyStrategy(Strategy):</code> <code>ValueError: data must be a pandas.DataFrame</code> \u30c7\u30fc\u30bf\u304cDataFrame\u3067\u306a\u3044 <code>pd.DataFrame(data)</code> <code>ValueError: Some OHLC values are missing</code> \u6b20\u640d\u5024\u304c\u3042\u308b <code>data.dropna()</code> <code>ValueError: size\u306f\u6b63\u306e\u8cc7\u7523\u5272\u5408\u307e\u305f\u306f\u6b63\u306e\u6574\u6570\u5358\u4f4d\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059</code> \u53d6\u5f15\u30b5\u30a4\u30ba\u304c\u7121\u52b9 <code>size=0.1</code> \u307e\u305f\u306f <code>size=100</code> <code>requests.RequestException: Failed to fetch data</code> API\u63a5\u7d9a\u30a8\u30e9\u30fc \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u3092\u78ba\u8a8d <code>AttributeError: 'MyStrategy' object has no attribute 'data'</code> <code>init()</code>\u3067<code>self.data</code>\u306b\u30a2\u30af\u30bb\u30b9 <code>init()</code>\u3067\u306f<code>self.data</code>\u3092\u4f7f\u7528\u53ef\u80fd"},{"location":"troubleshooting/#_17","title":"\u30c7\u30d0\u30c3\u30b0\u306e\u30d2\u30f3\u30c8","text":"<ol> <li> <p>\u30ed\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b <pre><code>import logging\nlogging.basicConfig(level=logging.DEBUG)\n</code></pre></p> </li> <li> <p>\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\u3059\u308b <pre><code>print(\"\u30c7\u30fc\u30bf\u5f62\u72b6:\", data.shape)\nprint(\"\u30c7\u30fc\u30bf\u5217:\", data.columns.tolist())\nprint(\"\u6b20\u640d\u5024:\", data.isnull().sum())\n</code></pre></p> </li> <li> <p>\u6226\u7565\u306e\u52d5\u4f5c\u3092\u78ba\u8a8d\u3059\u308b <pre><code>class DebugStrategy(Strategy):\n    def init(self):\n        print(\"\u6226\u7565\u521d\u671f\u5316\")\n\n    def next(self):\n        for code, df in self.data.items():\n            if len(df) % 100 == 0:\n                print(f\"\u30d0\u30fc {len(df)}: \u30a8\u30af\u30a4\u30c6\u30a3 {self.equity}\")\n</code></pre></p> </li> <li> <p>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u8ffd\u52a0\u3059\u308b <pre><code>try:\n    bt = Backtest({'TEST': data}, MyStrategy)\n    results = bt.run()\nexcept Exception as e:\n    print(f\"\u30a8\u30e9\u30fc: {e}\")\n    print(f\"\u30a8\u30e9\u30fc\u30bf\u30a4\u30d7: {type(e)}\")\n    import traceback\n    traceback.print_exc()\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#_18","title":"\u30b5\u30dd\u30fc\u30c8","text":"<p>\u554f\u984c\u304c\u89e3\u6c7a\u3057\u306a\u3044\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u65b9\u6cd5\u3067\u30b5\u30dd\u30fc\u30c8\u3092\u53d7\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff1a</p> <ol> <li>GitHub Issues: \u30d0\u30b0\u5831\u544a\u3084\u6a5f\u80fd\u8981\u6c42</li> <li>Discord: \u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u3067\u306e\u8cea\u554f</li> <li>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8: \u8a73\u7d30\u306a\u4f7f\u7528\u65b9\u6cd5\u306e\u78ba\u8a8d</li> </ol>"},{"location":"troubleshooting/#_19","title":"\u307e\u3068\u3081","text":"<p>\u3053\u306e\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u30ac\u30a4\u30c9\u3067\u306f\u3001BackcastPro\u3092\u4f7f\u7528\u3059\u308b\u969b\u306b\u3088\u304f\u767a\u751f\u3059\u308b\u554f\u984c\u3068\u305d\u306e\u89e3\u6c7a\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3057\u305f\u3002\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306f\u3001\u307e\u305a\u3053\u306e\u30ac\u30a4\u30c9\u3092\u78ba\u8a8d\u3057\u3001\u9069\u5207\u306a\u89e3\u6c7a\u65b9\u6cd5\u3092\u8a66\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"tutorial/","title":"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","text":"<p>BackcastPro\u3092\u4f7f\u3063\u305f\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"tutorial/#_2","title":"\u76ee\u6b21","text":"<ol> <li>\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb</li> <li>\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9</li> <li>\u6700\u521d\u306e\u6226\u7565</li> <li>\u30c7\u30fc\u30bf\u306e\u53d6\u5f97</li> <li>\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u306e\u5b9f\u884c</li> <li>\u30ea\u30d7\u30ec\u30a4\u578b\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc</li> <li>\u7d50\u679c\u306e\u89e3\u91c8</li> <li>marimo\u9023\u643a</li> <li>\u6b21\u306e\u30b9\u30c6\u30c3\u30d7</li> </ol>"},{"location":"tutorial/#windows","title":"\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\uff08Windows\uff09","text":"<pre><code>python -m pip install BackcastPro\n</code></pre>"},{"location":"tutorial/#_3","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<p>BackcastPro\u306f**\u30ea\u30d7\u30ec\u30a4\u578b\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc**\u3067\u3059\u30021\u30d0\u30fc\u305a\u3064\u6642\u9593\u3092\u9032\u3081\u306a\u304c\u3089\u3001\u6226\u7565\u3092\u5b9f\u884c\u3057\u3066\u30c1\u30e3\u30fc\u30c8\u3068\u58f2\u8cb7\u3092\u53ef\u8996\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>sequenceDiagram\n    participant U as User\n    participant D as DataReader\n    participant B as Backtest\n    participant S as Strategy Function\n    participant R as Results\n    U-&gt;&gt;D: DataReader('7203.JP', 'stooq')\n    D--&gt;&gt;U: OHLCV DataFrame\n    U-&gt;&gt;B: Backtest(data={code: df})\n    loop \u5404\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\n        U-&gt;&gt;S: my_strategy(bt)\n        S-&gt;&gt;B: buy()/sell()\n        U-&gt;&gt;B: step()\n    end\n    U-&gt;&gt;B: finalize()\n    B--&gt;&gt;R: pd.Series\uff08\u7d71\u8a08\u542b\u3080\uff09</code></pre>"},{"location":"tutorial/#1","title":"1. \u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30a4\u30f3\u30dd\u30fc\u30c8","text":"<pre><code>from BackcastPro import Backtest\nimport pandas as pd\n</code></pre>"},{"location":"tutorial/#2","title":"2. \u30c7\u30fc\u30bf\u306e\u6e96\u5099","text":"<pre><code>import yfinance as yf\n\n# \u30c8\u30e8\u30bf\u306e\u682a\u4fa1\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\ncode = '7203.T'  # \u6771\u8a3c\u306e\u9298\u67c4\u30b3\u30fc\u30c9\ndf = yf.download(code, period='1y')\nprint(df.head())\n</code></pre>"},{"location":"tutorial/#_4","title":"\u6700\u521d\u306e\u6226\u7565","text":""},{"location":"tutorial/#_5","title":"\u30b7\u30f3\u30d7\u30eb\u306a\u8cb7\u3044\u6301\u3061\u6226\u7565","text":"<p>\u6700\u521d\u306b\u3001\u4e00\u5ea6\u3060\u3051\u8cb7\u3046\u300c\u8cb7\u3044\u6301\u3061\u300d\u6226\u7565\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff1a</p> <pre><code>def buy_and_hold(bt):\n    \"\"\"\u6700\u521d\u306e\u30d0\u30fc\u3067\u4e00\u5ea6\u3060\u3051\u8cb7\u3046\"\"\"\n    if bt.position == 0:\n        bt.buy(tag=\"initial_buy\")\n</code></pre>"},{"location":"tutorial/#_6","title":"\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u306e\u5b9f\u884c","text":"<pre><code># \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3092\u521d\u671f\u5316\nbt = Backtest(data={code: df}, cash=10000, commission=0.001)\n\n# \u4e00\u62ec\u5b9f\u884c\nresults = bt.run_with_strategy(buy_and_hold)\nprint(results)\n</code></pre>"},{"location":"tutorial/#_7","title":"\u30c7\u30fc\u30bf\u306e\u53d6\u5f97","text":""},{"location":"tutorial/#_8","title":"\u65e5\u672c\u682a\u30c7\u30fc\u30bf\u306e\u53d6\u5f97","text":"<pre><code>import yfinance as yf\n\n# \u7279\u5b9a\u306e\u9298\u67c4\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\ntoyota_data = yf.download('7203.T', period='1y')  # \u30c8\u30e8\u30bf\nsony_data = yf.download('6758.T', period='1y')    # \u30bd\u30cb\u30fc\n\n# \u671f\u9593\u3092\u6307\u5b9a\u3057\u3066\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\nfrom datetime import datetime, timedelta\n\nend_date = datetime.now()\nstart_date = end_date - timedelta(days=365)  # 1\u5e74\u524d\n\ndata = yf.download('7203.T', start=start_date, end=end_date)\n</code></pre>"},{"location":"tutorial/#_9","title":"\u30ab\u30b9\u30bf\u30e0\u30c7\u30fc\u30bf\u306e\u4f7f\u7528","text":"<pre><code>import pandas as pd\n\n# \u30ab\u30b9\u30bf\u30e0\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\ncustom_data = pd.DataFrame({\n    'Open': [100, 101, 102, 103, 104],\n    'High': [105, 106, 107, 108, 109],\n    'Low': [99, 100, 101, 102, 103],\n    'Close': [104, 105, 106, 107, 108],\n    'Volume': [1000, 1100, 1200, 1300, 1400]\n}, index=pd.date_range('2023-01-01', periods=5))\n\n# \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3067\u4f7f\u7528\nbt = Backtest(data={'CUSTOM': custom_data}, cash=10000)\nresults = bt.run_with_strategy(buy_and_hold)\n</code></pre>"},{"location":"tutorial/#_10","title":"\u8907\u6570\u9298\u67c4\u306e\u540c\u6642\u30d0\u30c3\u30af\u30c6\u30b9\u30c8","text":"<pre><code># \u8907\u6570\u306e\u9298\u67c4\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\ntoyota_data = yf.download('7203.T', period='1y')\nsony_data = yf.download('6758.T', period='1y')\n\n# \u8907\u6570\u9298\u67c4\u3067\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3092\u521d\u671f\u5316\nbt = Backtest(\n    data={\n        '7203.T': toyota_data,\n        '6758.T': sony_data\n    },\n    cash=10000\n)\n\n# \u8907\u6570\u9298\u67c4\u5bfe\u5fdc\u306e\u6226\u7565\ndef multi_stock_strategy(bt):\n    for code in bt.data.keys():\n        pos = bt.position_of(code)  # \u26a0\ufe0f \u8907\u6570\u9298\u67c4\u6642\u306f position_of \u3092\u4f7f\u7528\n        if pos == 0:\n            bt.buy(code=code, tag=\"buy\")\n\nresults = bt.run_with_strategy(multi_stock_strategy)\n</code></pre>"},{"location":"tutorial/#_11","title":"\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u306e\u5b9f\u884c","text":""},{"location":"tutorial/#1_1","title":"\u65b9\u6cd51: \u4e00\u62ec\u5b9f\u884c\uff08\u63a8\u5968\uff09","text":"<pre><code>bt = Backtest(\n    data={code: df},\n    cash=10000,\n    commission=0.001,\n    finalize_trades=True,\n)\nresults = bt.run_with_strategy(my_strategy)\n</code></pre>"},{"location":"tutorial/#2_1","title":"\u65b9\u6cd52: \u30b9\u30c6\u30c3\u30d7\u5b9f\u884c","text":"<pre><code>bt = Backtest(data={code: df}, cash=10000)\n\nwhile not bt.is_finished:\n    my_strategy(bt)\n    bt.step()\n\nresults = bt.finalize()\n</code></pre>"},{"location":"tutorial/#_12","title":"\u30ea\u30d7\u30ec\u30a4\u578b\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc","text":"<p>BackcastPro\u306e\u7279\u5fb4\u306f\u3001**1\u30d0\u30fc\u305a\u3064\u6642\u9593\u3092\u9032\u3081\u306a\u304c\u3089\u53ef\u8996\u5316**\u3067\u304d\u308b\u3053\u3068\u3067\u3059\u3002</p>"},{"location":"tutorial/#_13","title":"\u30b9\u30c6\u30c3\u30d7\u5b9f\u884c\u306e\u57fa\u672c","text":"<pre><code>bt = Backtest(data={code: df}, cash=10000)\n\n# 10\u30d0\u30fc\u9032\u3081\u308b\nfor _ in range(10):\n    my_strategy(bt)\n    bt.step()\n\n    # \u73fe\u5728\u306e\u72b6\u614b\u3092\u78ba\u8a8d\n    print(f\"\u6642\u9593: {bt.current_time}\")\n    print(f\"\u9032\u6357: {bt.progress * 100:.1f}%\")\n    print(f\"\u8cc7\u7523: ${bt.equity:,.2f}\")\n    print(f\"\u30dd\u30b8\u30b7\u30e7\u30f3: {bt.position}\")\n    print(\"---\")\n</code></pre>"},{"location":"tutorial/#goto","title":"goto() \u3067\u4efb\u610f\u306e\u4f4d\u7f6e\u3078\u30b8\u30e3\u30f3\u30d7","text":"<pre><code># 100\u30d0\u30fc\u76ee\u307e\u3067\u9032\u3081\u308b\uff08\u6226\u7565\u3092\u9069\u7528\u3057\u306a\u304c\u3089\uff09\nbt.goto(100, strategy=my_strategy)\n\n# \u30c1\u30e3\u30fc\u30c8\u3092\u78ba\u8a8d\nchart = bt.chart()\nchart.show()\n</code></pre>"},{"location":"tutorial/#reset","title":"reset() \u3067\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057","text":"<pre><code>bt.reset()\n# \u518d\u5ea6\u5b9f\u884c\u53ef\u80fd\n</code></pre>"},{"location":"tutorial/#_14","title":"\u7d50\u679c\u306e\u89e3\u91c8","text":""},{"location":"tutorial/#_15","title":"\u57fa\u672c\u7684\u306a\u7d71\u8a08\u60c5\u5831","text":"<pre><code>results = bt.finalize()\n\n# \u4e3b\u8981\u306a\u7d71\u8a08\u60c5\u5831\u3092\u8868\u793a\nprint(f\"\u7dcf\u30ea\u30bf\u30fc\u30f3: {results['Return [%]']:.2f}%\")\nprint(f\"\u5e74\u7387\u30ea\u30bf\u30fc\u30f3: {results['Return (Ann.) [%]']:.2f}%\")\nprint(f\"\u30b7\u30e3\u30fc\u30d7\u30ec\u30b7\u30aa: {results['Sharpe Ratio']:.2f}\")\nprint(f\"\u6700\u5927\u30c9\u30ed\u30fc\u30c0\u30a6\u30f3: {results['Max. Drawdown [%]']:.2f}%\")\nprint(f\"\u53d6\u5f15\u56de\u6570: {results['# Trades']}\")\nprint(f\"\u52dd\u7387: {results['Win Rate [%]']:.2f}%\")\n</code></pre>"},{"location":"tutorial/#_16","title":"\u30a8\u30af\u30a4\u30c6\u30a3\u30ab\u30fc\u30d6\u306e\u78ba\u8a8d","text":"<pre><code># \u30a8\u30af\u30a4\u30c6\u30a3\u30ab\u30fc\u30d6\u3092\u53d6\u5f97\nequity_curve = results['_equity_curve']\nprint(equity_curve.head())\n\n# \u30c9\u30ed\u30fc\u30c0\u30a6\u30f3\u3092\u78ba\u8a8d\ndrawdown = equity_curve['DrawdownPct']\nprint(f\"\u6700\u5927\u30c9\u30ed\u30fc\u30c0\u30a6\u30f3: {drawdown.min():.2f}%\")\n</code></pre>"},{"location":"tutorial/#_17","title":"\u30c8\u30ec\u30fc\u30c9\u5c65\u6b74\u306e\u78ba\u8a8d","text":"<pre><code># \u30c8\u30ec\u30fc\u30c9\u5c65\u6b74\u3092\u53d6\u5f97\ntrades = results['_trades']\nprint(trades.head())\n\n# \u52dd\u3061\u30c8\u30ec\u30fc\u30c9\u3068\u8ca0\u3051\u30c8\u30ec\u30fc\u30c9\u3092\u5206\u6790\nwinning_trades = trades[trades['PnL'] &gt; 0]\nlosing_trades = trades[trades['PnL'] &lt; 0]\n\nprint(f\"\u52dd\u3061\u30c8\u30ec\u30fc\u30c9\u6570: {len(winning_trades)}\")\nprint(f\"\u8ca0\u3051\u30c8\u30ec\u30fc\u30c9\u6570: {len(losing_trades)}\")\n</code></pre>"},{"location":"tutorial/#marimo","title":"marimo\u9023\u643a","text":"<p>marimo\u3068\u9023\u643a\u3057\u3066\u3001\u30b9\u30e9\u30a4\u30c0\u30fc\u3067\u6642\u9593\u3092\u64cd\u4f5c\u3057\u306a\u304c\u3089\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u53ef\u8996\u5316\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"tutorial/#marimo_1","title":"\u57fa\u672c\u7684\u306amarimo\u9023\u643a","text":"<pre><code>import marimo as mo\nfrom BackcastPro import Backtest\n\n# \u30c7\u30fc\u30bf\u6e96\u5099\nbt = Backtest(data={\"AAPL\": df_aapl}, cash=100000)\n\n# \u6226\u7565\u5b9a\u7fa9\ndef my_strategy(bt):\n    df = bt.data.get(\"AAPL\")\n    if df is None or len(df) &lt; 2:\n        return\n\n    c0 = df[\"Close\"].iloc[-2]\n    c1 = df[\"Close\"].iloc[-1]\n\n    if bt.position == 0 and c1 &lt; c0:\n        bt.buy(tag=\"dip_buy\")\n    elif bt.position &gt; 0 and c1 &gt; c0:\n        bt.sell(tag=\"profit_take\")\n</code></pre>"},{"location":"tutorial/#ui","title":"UI\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb","text":"<pre><code># \u6642\u9593\u30b9\u30e9\u30a4\u30c0\u30fc\nslider = mo.ui.slider(\n    start=1,\n    stop=len(bt.index),\n    value=1,\n    label=\"\ud83d\udcc5 \u6642\u9593\",\n    show_value=True\n)\n\n# \u30b9\u30e9\u30a4\u30c0\u30fc\u4f4d\u7f6e\u307e\u3067\u9032\u3081\u308b\nbt.goto(slider.value, strategy=my_strategy)\n\n# \u30c1\u30e3\u30fc\u30c8\u63cf\u753b\uff08tag \u8868\u793a\u4ed8\u304d\uff09\nchart = bt.chart(height=500, show_tags=True)\n\n# \u60c5\u5831\u30d1\u30cd\u30eb\ninfo = mo.md(f\"\"\"\n### \ud83d\udcca \u72b6\u6cc1\n| \u9805\u76ee | \u5024 |\n|------|-----|\n| \u65e5\u6642 | {bt.current_time} |\n| \u9032\u6357 | {bt.progress * 100:.1f}% |\n| \u8cc7\u7523 | ${bt.equity:,.2f} |\n| \u30dd\u30b8\u30b7\u30e7\u30f3 | {bt.position} \u682a |\n\"\"\")\n\nmo.vstack([slider, chart, info])\n</code></pre>"},{"location":"tutorial/#_18","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":""},{"location":"tutorial/#1_2","title":"1. \u3088\u308a\u8907\u96d1\u306a\u6226\u7565\u306e\u5b9f\u88c5","text":"<pre><code>def moving_average_cross(bt):\n    \"\"\"\u79fb\u52d5\u5e73\u5747\u30af\u30ed\u30b9\u6226\u7565\"\"\"\n    df = bt.data.get(\"AAPL\")\n    if df is None or len(df) &lt; 20:\n        return\n\n    sma_short = df[\"Close\"].rolling(10).mean().iloc[-1]\n    sma_long = df[\"Close\"].rolling(20).mean().iloc[-1]\n    sma_short_prev = df[\"Close\"].rolling(10).mean().iloc[-2]\n    sma_long_prev = df[\"Close\"].rolling(20).mean().iloc[-2]\n\n    # \u30b4\u30fc\u30eb\u30c7\u30f3\u30af\u30ed\u30b9\u3067\u8cb7\u3044\n    if bt.position == 0 and sma_short &gt; sma_long and sma_short_prev &lt;= sma_long_prev:\n        bt.buy(tag=\"golden_cross\")\n\n    # \u30c7\u30c3\u30c9\u30af\u30ed\u30b9\u3067\u58f2\u308a\n    elif bt.position &gt; 0 and sma_short &lt; sma_long and sma_short_prev &gt;= sma_long_prev:\n        bt.sell(tag=\"dead_cross\")\n</code></pre>"},{"location":"tutorial/#2_2","title":"2. \u30ea\u30b9\u30af\u7ba1\u7406\u306e\u8ffd\u52a0","text":"<pre><code>def strategy_with_risk_management(bt):\n    if bt.position == 0:\n        price = bt.data[\"AAPL\"][\"Close\"].iloc[-1]\n        bt.buy(\n            sl=price * 0.95,  # 5%\u4e0b\u843d\u3067\u30b9\u30c8\u30c3\u30d7\u30ed\u30b9\n            tp=price * 1.10,  # 10%\u4e0a\u6607\u3067\u30c6\u30a4\u30af\u30d7\u30ed\u30d5\u30a3\u30c3\u30c8\n            tag=\"entry_with_sl_tp\"\n        )\n</code></pre>"},{"location":"tutorial/#3","title":"3. \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u53ef\u8996\u5316","text":"<pre><code>import matplotlib.pyplot as plt\n\n# \u30a8\u30af\u30a4\u30c6\u30a3\u30ab\u30fc\u30d6\u3092\u30d7\u30ed\u30c3\u30c8\nequity_curve = results['_equity_curve']\nplt.figure(figsize=(12, 6))\n\nplt.subplot(2, 1, 1)\nplt.plot(equity_curve.index, equity_curve['Equity'])\nplt.title('\u30a8\u30af\u30a4\u30c6\u30a3\u30ab\u30fc\u30d6')\nplt.ylabel('\u8cc7\u7523')\n\nplt.subplot(2, 1, 2)\nplt.plot(equity_curve.index, equity_curve['DrawdownPct'])\nplt.title('\u30c9\u30ed\u30fc\u30c0\u30a6\u30f3')\nplt.ylabel('\u30c9\u30ed\u30fc\u30c0\u30a6\u30f3 (%)')\n\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"tutorial/#_19","title":"\u3088\u304f\u3042\u308b\u8cea\u554f","text":""},{"location":"tutorial/#q","title":"Q: \u30c7\u30fc\u30bf\u304c\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u3067\u3059\u304b\uff1f","text":"<p>A: \u4ee5\u4e0b\u306e\u70b9\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\uff1a 1. \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a 2. \u9298\u67c4\u30b3\u30fc\u30c9\u306e\u6b63\u78ba\u6027 3. \u65e5\u4ed8\u7bc4\u56f2\u306e\u59a5\u5f53\u6027</p>"},{"location":"tutorial/#q_1","title":"Q: \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u304c\u9045\u3044\u5834\u5408\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u3067\u3059\u304b\uff1f","text":"<p>A: \u4ee5\u4e0b\u306e\u65b9\u6cd5\u3092\u8a66\u3057\u3066\u304f\u3060\u3055\u3044\uff1a 1. \u30c7\u30fc\u30bf\u671f\u9593\u3092\u77ed\u304f\u3059\u308b 2. \u8907\u96d1\u306a\u8a08\u7b97\u3092\u4e8b\u524d\u306b\u884c\u3063\u3066\u304a\u304f 3. \u4e0d\u8981\u306a\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3059\u308b</p>"},{"location":"tutorial/#q-position","title":"Q: \u8907\u6570\u9298\u67c4\u3067 position \u304c\u304a\u304b\u3057\u3044","text":"<p>A: \u8907\u6570\u9298\u67c4\u3092\u6271\u3046\u5834\u5408\u306f <code>bt.position</code> \u3067\u306f\u306a\u304f <code>bt.position_of(code)</code> \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002 <code>position</code> \u306f\u5168\u9298\u67c4\u5408\u8a08\u306e\u305f\u3081\u3001\u500b\u5225\u9298\u67c4\u306e\u30dd\u30b8\u30b7\u30e7\u30f3\u3092\u6b63\u78ba\u306b\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3002</p>"},{"location":"tutorial/#_20","title":"\u307e\u3068\u3081","text":"<ul> <li>\u30c7\u30fc\u30bf\u6e96\u5099 \u2192 Backtest\u521d\u671f\u5316 \u2192 \u6226\u7565\u95a2\u6570\u5b9a\u7fa9 \u2192 \u5b9f\u884c \u2192 \u5206\u6790 \u306e\u9806\u306b\u9032\u3081\u307e\u3059</li> <li><code>run_with_strategy()</code> \u3067\u4e00\u62ec\u5b9f\u884c\u3001\u307e\u305f\u306f <code>step()</code> \u3067\u30b9\u30c6\u30c3\u30d7\u5b9f\u884c</li> <li><code>chart()</code> \u3067\u58f2\u8cb7\u30de\u30fc\u30ab\u30fc\u4ed8\u304d\u30c1\u30e3\u30fc\u30c8\u3092\u751f\u6210</li> <li>marimo\u9023\u643a\u3067\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u306a\u53ef\u8996\u5316\u304c\u53ef\u80fd</li> </ul>"},{"location":"plans/chart-performance-optimization/","title":"Lightweight Charts \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316","text":""},{"location":"plans/chart-performance-optimization/#_1","title":"\u30b9\u30c6\u30fc\u30bf\u30b9: \u2705 \u5b8c\u4e86\uff08\u30d0\u30b0\u4fee\u6b63\u542b\u3080\uff09","text":"<p>\u5b9f\u88c5\u65e5: 2026-01-25 TDD: RED \u2192 GREEN \u2192 REFACTOR \u5b8c\u4e86 \u30d0\u30b0\u4fee\u6b63: 2026-01-25 - marimo anywidget \u3068\u306e\u4e92\u63db\u6027\u554f\u984c\u3092\u89e3\u6c7a</p>"},{"location":"plans/chart-performance-optimization/#_2","title":"\u6982\u8981","text":"<p>marimo\u304b\u3089<code>Backtest.chart()</code>\u3092\u9023\u7d9a\u547c\u3073\u51fa\u3057\u3059\u308b\u969b\u3001\u30c7\u30fc\u30bf\u91cf\u5897\u52a0\u306b\u4f34\u3046\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u4f4e\u4e0b\u3092\u89e3\u6d88\u3002</p>"},{"location":"plans/chart-performance-optimization/#_3","title":"\u554f\u984c\u3068\u89e3\u6c7a","text":""},{"location":"plans/chart-performance-optimization/#before","title":"Before\uff08\u554f\u984c\uff09","text":"<pre><code>bt.chart() \u547c\u3073\u51fa\u3057\n    \u2193\nchart_by_df() \u3067\u65b0\u898f\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u4f5c\u6210  \u2190 \u6bce\u56de\u767a\u751f\n    \u2193\ndf_to_lwc_data(df) \u3067\u5168\u30c7\u30fc\u30bf\u5909\u63db     \u2190 O(n) \u51e6\u7406\n    \u2193\nJS\u5074\u3067 setData() \u304c\u5168\u30c7\u30fc\u30bf\u518d\u63cf\u753b    \u2190 O(n) \u51e6\u7406\n</code></pre>"},{"location":"plans/chart-performance-optimization/#after","title":"After\uff08\u89e3\u6c7a\uff09","text":"<pre><code>\u521d\u56de: bt.chart() \u2192 \u65b0\u898f\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8 + \u5168\u30c7\u30fc\u30bf\u8a2d\u5b9a\n2\u56de\u76ee\u4ee5\u964d: bt.chart() \u2192 \u65e2\u5b58\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8 + data\u914d\u5217\u66f4\u65b0 + last_bar \u5dee\u5206\u66f4\u65b0\n</code></pre>"},{"location":"plans/chart-performance-optimization/#_4","title":"\u5b9f\u88c5\u5185\u5bb9","text":""},{"location":"plans/chart-performance-optimization/#_5","title":"\u5909\u66f4\u30d5\u30a1\u30a4\u30eb","text":"\u30d5\u30a1\u30a4\u30eb \u5909\u66f4\u5185\u5bb9 <code>src/BackcastPro/backtest.py</code> \u30ad\u30e3\u30c3\u30b7\u30e5\u5c5e\u6027\u8ffd\u52a0\u3001chart()\u5dee\u5206\u66f4\u65b0\u3001reset()\u6539\u4fee <code>src/BackcastPro/api/chart.py</code> \u30c1\u30e3\u30fc\u30c8\u3092<code>model</code>\u306b\u4fdd\u5b58\uff08marimo\u5bfe\u5fdc\uff09 <code>tests/test_backtest_chart_cache.py</code> 16\u30c6\u30b9\u30c8\u65b0\u898f\u8ffd\u52a0"},{"location":"plans/chart-performance-optimization/#phase-1","title":"Phase 1: \u30ad\u30e3\u30c3\u30b7\u30e5\u5c5e\u6027\u8ffd\u52a0 \u2705","text":"<pre><code># src/BackcastPro/backtest.py:129-131\nself._chart_widgets: dict = {}\nself._chart_last_index: dict[str, int] = {}\n</code></pre>"},{"location":"plans/chart-performance-optimization/#phase-2-chart","title":"Phase 2: chart() \u5dee\u5206\u66f4\u65b0\u5bfe\u5fdc \u2705","text":"<pre><code>def chart(self, code: str = None, height: int = 500, show_tags: bool = True):\n    \"\"\"\n    \u5dee\u5206\u66f4\u65b0\u5bfe\u5fdc:\n    - \u521d\u56de\u547c\u3073\u51fa\u3057: \u5168\u30c7\u30fc\u30bf\u3067\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u4f5c\u6210\n    - 2\u56de\u76ee\u4ee5\u964d: \u65e2\u5b58\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u3092\u518d\u5229\u7528\u3057\u5dee\u5206\u66f4\u65b0\n    \"\"\"\n    # \u30ad\u30e3\u30c3\u30b7\u30e5\u78ba\u8a8d\n    if code in self._chart_widgets:\n        widget = self._chart_widgets[code]\n        last_idx = self._chart_last_index.get(code, 0)\n\n        # \u5dfb\u304d\u623b\u3057\u307e\u305f\u306f\u5927\u304d\u306a\u30b8\u30e3\u30f3\u30d7\u306e\u5834\u5408\u306f\u5168\u30c7\u30fc\u30bf\u66f4\u65b0\n        needs_full_update = (\n            last_idx == 0 or\n            current_idx &lt; last_idx or\n            current_idx - last_idx &gt; 1\n        )\n\n        if needs_full_update:\n            widget.data = df_to_lwc_data(df)\n        else:\n            # \u5dee\u5206\u66f4\u65b0: last_bar \u3068 data \u306e\u4e21\u65b9\u3092\u66f4\u65b0\n            widget.last_bar = get_last_bar(df)\n            widget.data = df_to_lwc_data(df)  # \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u7528\n\n        widget.markers = trades_to_markers(all_trades, code, show_tags)\n        return widget\n\n    # \u521d\u56de: \u65b0\u898f\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u4f5c\u6210\n    widget = chart_by_df(df, ...)\n    self._chart_widgets[code] = widget\n    return widget\n</code></pre>"},{"location":"plans/chart-performance-optimization/#phase-3-reset","title":"Phase 3: reset() \u6539\u4fee \u2705","text":"<pre><code>def reset(self, *, clear_chart_cache: bool = False) -&gt; 'Backtest':\n    \"\"\"\n    Args:\n        clear_chart_cache: \u30c1\u30e3\u30fc\u30c8\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u30af\u30ea\u30a2\u3059\u308b\u304b\n                          \uff08\u30c7\u30d5\u30a9\u30eb\u30c8: False \u3067\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u306f\u518d\u5229\u7528\uff09\n    \"\"\"\n    # \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30ea\u30bb\u30c3\u30c8\uff08\u6b21\u56dechart()\u3067\u5168\u30c7\u30fc\u30bf\u66f4\u65b0\uff09\n    self._chart_last_index = {}\n    # \u660e\u793a\u7684\u306b\u6307\u5b9a\u3055\u308c\u305f\u5834\u5408\u306e\u307f\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u3092\u30af\u30ea\u30a2\n    if clear_chart_cache:\n        self._chart_widgets = {}\n</code></pre>"},{"location":"plans/chart-performance-optimization/#marimo-anywidget","title":"\u30d0\u30b0\u4fee\u6b63: marimo anywidget \u4e92\u63db\u6027\u554f\u984c","text":""},{"location":"plans/chart-performance-optimization/#_6","title":"\u767a\u898b\u3055\u308c\u305f\u554f\u984c","text":"<p>\u521d\u671f\u5b9f\u88c5\u3067\u306f\u3001\u30ed\u30fc\u30bd\u30af\u8db3\u304c1\u672c\u3057\u304b\u8868\u793a\u3055\u308c\u306a\u3044\u30d0\u30b0\u304c\u3042\u3063\u305f\u3002</p>"},{"location":"plans/chart-performance-optimization/#_7","title":"\u539f\u56e0","text":"<ol> <li>marimo \u306e AnyWidgetPlugin: \u5024\u304c\u5909\u308f\u308b\u305f\u3073\u306b <code>render()</code> \u3092\u518d\u547c\u3073\u51fa\u3057</li> <li>\u7570\u306a\u308b el \u8981\u7d20: \u6bce\u56de\u7570\u306a\u308b DOM \u8981\u7d20\u304c\u6e21\u3055\u308c\u308b\u53ef\u80fd\u6027</li> <li>el[CHART_KEY] \u30c1\u30a7\u30c3\u30af\u5931\u6557: \u65b0\u3057\u3044 el \u306b\u306f\u65e2\u5b58\u30c1\u30e3\u30fc\u30c8\u3078\u306e\u53c2\u7167\u304c\u306a\u3044</li> <li>last_bar \u66f4\u65b0\u306e\u6b20\u843d: \u30c1\u30e3\u30fc\u30c8\u4f5c\u6210\u4e2d\uff08CDN\u8aad\u307f\u8fbc\u307f\uff09\u306b\u767a\u706b\u3057\u305f\u66f4\u65b0\u304c\u5931\u308f\u308c\u308b</li> </ol>"},{"location":"plans/chart-performance-optimization/#_8","title":"\u4fee\u6b63\u5185\u5bb9","text":""},{"location":"plans/chart-performance-optimization/#1-chartpy-model","title":"1. chart.py - \u30c1\u30e3\u30fc\u30c8\u3092 model \u306b\u4fdd\u5b58","text":"<pre><code>// \u4fee\u6b63\u524d\nif (el[CHART_KEY]) { ... }\nel[CHART_KEY] = chart;\n\n// \u4fee\u6b63\u5f8c\nconst MODEL_CHART_KEY = '__lwcChart';\nif (model[MODEL_CHART_KEY]) { ... }\nmodel[MODEL_CHART_KEY] = chart;\n</code></pre>"},{"location":"plans/chart-performance-optimization/#2-backtestpy-data","title":"2. backtest.py - \u5dee\u5206\u66f4\u65b0\u6642\u3082 data \u3092\u66f4\u65b0","text":"<pre><code># \u4fee\u6b63\u5f8c\uff08\u5dee\u5206\u66f4\u65b0\u6642\uff09\nwidget.last_bar = get_last_bar(df)\nwidget.data = df_to_lwc_data(df)  # \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u7528\n</code></pre> <p>\u7406\u7531: <code>last_bar</code> \u306e\u66f4\u65b0\u304c\u30c1\u30e3\u30fc\u30c8\u4f5c\u6210\u524d\u306b\u5931\u308f\u308c\u3066\u3082\u3001<code>data</code> \u306b\u30d5\u30eb\u30c7\u30fc\u30bf\u304c\u3042\u308c\u3070 <code>change:data</code> \u30a4\u30d9\u30f3\u30c8\u3067\u5fa9\u65e7\u53ef\u80fd</p>"},{"location":"plans/chart-performance-optimization/#_9","title":"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<p>\u8a73\u7d30\u306f <code>chart-fix-handoff.md</code> \u3092\u53c2\u7167\u3002</p>"},{"location":"plans/chart-performance-optimization/#_10","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u7d50\u679c","text":"\u6307\u6a19 \u6539\u4fee\u524d \u6539\u4fee\u5f8c \u66f4\u65b0\u6642\u9593\u8a08\u7b97\u91cf O(n) O(1)* \u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u751f\u6210 \u6bce\u56de \u521d\u56de\u306e\u307f 50\u56de\u9023\u7d9a\u547c\u3073\u51fa\u3057 - 0.005\u79d2 \u5e73\u5747\u30ec\u30b9\u30dd\u30f3\u30b9 - 0.10ms/call <p>*\u6ce8: <code>data</code> \u914d\u5217\u3082\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u7528\u306b\u66f4\u65b0\u3055\u308c\u308b\u304c\u3001JS\u5074\u306e <code>change:last_bar</code> \u30ea\u30b9\u30ca\u30fc\u304c\u52b9\u7387\u7684\u306a\u5dee\u5206\u66f4\u65b0\u3092\u884c\u3046</p>"},{"location":"plans/chart-performance-optimization/#_11","title":"\u30c6\u30b9\u30c8\u7d50\u679c","text":""},{"location":"plans/chart-performance-optimization/#16","title":"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8: 16\u4ef6 \u2705","text":"\u30c6\u30b9\u30c8\u30af\u30e9\u30b9 \u30c6\u30b9\u30c8\u6570 \u72b6\u614b TestChartWidgetCaching 4 \u2705 TestIncrementalUpdate 2 \u2705 TestChartCacheAttributes 5 \u2705 TestRewindBehavior 2 \u2705 TestEdgeCases 3 \u2705"},{"location":"plans/chart-performance-optimization/#24","title":"\u65e2\u5b58\u30c6\u30b9\u30c8\u3068\u306e\u4e92\u63db\u6027: 24\u4ef6 \u2705","text":"<p><code>test_lightweight_chart_widget.py</code> \u306e\u5168\u30c6\u30b9\u30c8\u304c\u5f15\u304d\u7d9a\u304d\u6210\u529f\u3002</p>"},{"location":"plans/chart-performance-optimization/#e2e","title":"E2E\u691c\u8a3c \u2705","text":"<p><pre><code>cd \"C:/Users/sasai/Documents/marimo/frontend\" &amp;&amp; node test_chart.cjs\n</code></pre> - \u2705 \u8907\u6570\u306e\u30ed\u30fc\u30bd\u30af\u8db3\u304c\u8868\u793a\u3055\u308c\u308b - \u2705 \u30c1\u30e3\u30fc\u30c8\u306e\u518d\u5229\u7528\u304c\u6a5f\u80fd - \u2705 <code>change:data</code> / <code>change:last_bar</code> \u30a4\u30d9\u30f3\u30c8\u304c\u6b63\u5e38\u306b\u767a\u706b</p>"},{"location":"plans/chart-performance-optimization/#_12","title":"\u4f7f\u7528\u65b9\u6cd5","text":"<p>\u65e2\u5b58\u306e\u30b3\u30fc\u30c9\u5909\u66f4\u4e0d\u8981\u3002\u305d\u306e\u307e\u307e\u9ad8\u901f\u5316\u306e\u6069\u6075\u3092\u53d7\u3051\u3089\u308c\u308b\u3002</p> <pre><code># fintech1.py\uff08\u5909\u66f4\u4e0d\u8981\uff09\nbt.goto(target_step, strategy=my_strategy)\nchart = bt.chart(code=code)  # \u81ea\u52d5\u7684\u306b\u30ad\u30e3\u30c3\u30b7\u30e5\uff06\u5dee\u5206\u66f4\u65b0\n</code></pre>"},{"location":"plans/chart-performance-optimization/#_13","title":"\u30aa\u30d7\u30b7\u30e7\u30f3: \u30ad\u30e3\u30c3\u30b7\u30e5\u5f37\u5236\u30af\u30ea\u30a2","text":"<pre><code>bt.reset(clear_chart_cache=True)  # \u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u3082\u65b0\u898f\u4f5c\u6210\n</code></pre>"},{"location":"plans/chart-performance-optimization/#_14","title":"\u4eca\u5f8c\u306e\u62e1\u5f35\uff08\u672a\u5b9f\u88c5\uff09","text":"<ul> <li> <code>max_bars</code> \u30d1\u30e9\u30e1\u30fc\u30bf\u8ffd\u52a0\uff08\u5927\u91cf\u30c7\u30fc\u30bf\u5bfe\u7b56\uff09</li> <li> Volume \u30c7\u30fc\u30bf\u306e\u5dee\u5206\u66f4\u65b0\u5bfe\u5fdc</li> </ul>"},{"location":"plans/chart-performance-optimization/#_15","title":"\u95a2\u9023\u30d5\u30a1\u30a4\u30eb","text":"<ul> <li>\u8a08\u753b\u66f8: <code>docs/plans/chart-performance-optimization.md</code></li> <li>\u30d0\u30b0\u4fee\u6b63: <code>docs/plans/chart-fix-handoff.md</code></li> <li>\u5b9f\u88c5: <code>src/BackcastPro/backtest.py:401-478</code></li> <li>\u30c1\u30e3\u30fc\u30c8JS: <code>src/BackcastPro/api/chart.py</code></li> <li>\u30c6\u30b9\u30c8: <code>tests/test_backtest_chart_cache.py</code></li> </ul>"},{"location":"plans/fix-autoplay-switch-ui/","title":"\u4f5c\u696d\u4f9d\u983c: \u81ea\u52d5\u518d\u751f\u30b9\u30a4\u30c3\u30c1\u306eUI\u72b6\u614b\u304c\u66f4\u65b0\u3055\u308c\u306a\u3044\u554f\u984c","text":""},{"location":"plans/fix-autoplay-switch-ui/#_1","title":"\u6982\u8981","text":"<p><code>fintech1.py</code> \u306e\u81ea\u52d5\u518d\u751f\u6a5f\u80fd\u306f\u52d5\u4f5c\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u304c\u3001UI\u306e\u30b9\u30a4\u30c3\u30c1\u304c ON \u72b6\u614b\u3092\u53cd\u6620\u3057\u306a\u3044\u3002</p>"},{"location":"plans/fix-autoplay-switch-ui/#_2","title":"\u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb","text":"<p><code>C:\\Users\\sasai\\AppData\\Local\\Temp\\fintech1.py</code></p>"},{"location":"plans/fix-autoplay-switch-ui/#_3","title":"\u73fe\u5728\u306e\u554f\u984c","text":"<p><code>toggle_run()</code> \u3092\u5b9f\u884c\u3059\u308b\u3068: - \u2705 \u81ea\u52d5\u518d\u751f\u306f\u52d5\u4f5c\u3059\u308b\uff08<code>bt.step()</code> \u304c500ms\u3054\u3068\u306b\u547c\u3070\u308c\u3066\u30c1\u30e3\u30fc\u30c8\u304c\u66f4\u65b0\u3055\u308c\u308b\uff09 - \u274c \u30b9\u30a4\u30c3\u30c1\u306eUI\u304cOFF\u306e\u307e\u307e\uff08<code>set_playing(True)</code> \u3092\u547c\u3093\u3067\u3082\u30b9\u30a4\u30c3\u30c1\u306e\u898b\u305f\u76ee\u304c\u5909\u308f\u3089\u306a\u3044\uff09</p>"},{"location":"plans/fix-autoplay-switch-ui/#_4","title":"\u539f\u56e0","text":"<pre><code>_play_switch = mo.ui.switch(label=\"\u81ea\u52d5\u518d\u751f\", value=get_playing())\n</code></pre> <p>\u30b9\u30a4\u30c3\u30c1\u306e <code>value</code> \u306f\u521d\u671f\u5316\u6642\u306e <code>get_playing()</code> \u306e\u5024\uff08False\uff09\u3067\u56fa\u5b9a\u3055\u308c\u3066\u3044\u308b\u3002 <code>set_playing(True)</code> \u3092\u547c\u3093\u3067\u3082\u3001\u30b9\u30a4\u30c3\u30c1\u306eUI\u81ea\u4f53\u306f\u518d\u4f5c\u6210\u3055\u308c\u306a\u3044\u305f\u3081\u3001\u898b\u305f\u76ee\u304c\u66f4\u65b0\u3055\u308c\u306a\u3044\u3002</p>"},{"location":"plans/fix-autoplay-switch-ui/#_5","title":"\u4fee\u6b63\u65b9\u91dd","text":"<p>marimo\u3067\u30b9\u30a4\u30c3\u30c1\u3068state\u3092\u540c\u671f\u3055\u305b\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u306e\u65b9\u6cd5\u304c\u3042\u308b:</p>"},{"location":"plans/fix-autoplay-switch-ui/#1-on_change-statestate","title":"\u65b9\u6cd51: \u30b9\u30a4\u30c3\u30c1\u306e <code>on_change</code> \u3067state\u3092\u66f4\u65b0\u3057\u3001state\u306e\u5909\u66f4\u3067\u30b9\u30a4\u30c3\u30c1\u3092\u518d\u4f5c\u6210","text":"<pre><code>@app.cell\ndef _():\n    import marimo as mo\n\n    get_playing, set_playing = mo.state(False)\n    return get_playing, set_playing, mo\n\n@app.cell\ndef _(get_playing, set_playing, mo):\n    # get_playing() \u306b\u4f9d\u5b58\u3055\u305b\u308b\u3053\u3068\u3067\u3001state\u5909\u66f4\u6642\u306b\u518d\u4f5c\u6210\u3055\u308c\u308b\n    _play_switch = mo.ui.switch(\n        label=\"\u81ea\u52d5\u518d\u751f\",\n        value=get_playing(),\n        on_change=lambda v: set_playing(v)\n    )\n    _play_switch\n    return (_play_switch,)\n</code></pre>"},{"location":"plans/fix-autoplay-switch-ui/#2-state","title":"\u65b9\u6cd52: \u30b9\u30a4\u30c3\u30c1\u306e\u5024\u3092\u76f4\u63a5\u4f7f\u3046\uff08state\u3092\u4f7f\u308f\u306a\u3044\uff09","text":"<pre><code>@app.cell\ndef _(mo):\n    play_switch = mo.ui.switch(label=\"\u81ea\u52d5\u518d\u751f\")\n    play_switch\n    return (play_switch,)\n\n@app.cell\ndef _(play_switch, bt, mo):\n    # \u30b9\u30a4\u30c3\u30c1\u306e\u5024\u306b\u4f9d\u5b58\n    if play_switch.value:\n        mo.Thread(target=_game_loop).start()\n</code></pre>"},{"location":"plans/fix-autoplay-switch-ui/#_6","title":"\u691c\u8a3c\u65b9\u6cd5","text":"<ol> <li><code>marimo edit C:\\Users\\sasai\\AppData\\Local\\Temp\\fintech1.py</code></li> <li>\u30b9\u30a4\u30c3\u30c1\u3092ON\u306b\u3059\u308b</li> <li>\u81ea\u52d5\u518d\u751f\u304c\u958b\u59cb\u3055\u308c\u3001\u30b9\u30a4\u30c3\u30c1\u304cON\u72b6\u614b\u3092\u7dad\u6301\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d</li> <li>\u30b9\u30a4\u30c3\u30c1\u3092OFF\u306b\u3059\u308b</li> <li>\u81ea\u52d5\u518d\u751f\u304c\u505c\u6b62\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d</li> </ol>"},{"location":"plans/fix-autoplay-switch-ui/#_7","title":"\u95a2\u9023\u60c5\u5831","text":"<ul> <li>marimo\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8: https://docs.marimo.io/guides/state/</li> <li><code>mo.state()</code> \u306e\u30ea\u30a2\u30af\u30c6\u30a3\u30d3\u30c6\u30a3: state\u304c\u5909\u66f4\u3055\u308c\u308b\u3068\u3001\u305d\u306estate\u3092\u53c2\u7167\u3059\u308b\u30bb\u30eb\u304c\u518d\u5b9f\u884c\u3055\u308c\u308b</li> </ul>"},{"location":"plans/lightweight-chart-update-fix/","title":"Lightweight Chart \u66f4\u65b0\u554f\u984c\u306e\u4fee\u6b63","text":""},{"location":"plans/lightweight-chart-update-fix/#_1","title":"\u6982\u8981","text":"<p>\u65e5\u4ed8: 2026-01-27 \u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb: <code>src/BackcastPro/backtest.py</code> \u95a2\u9023: marimo \u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u3067\u306e chart \u8868\u793a</p>"},{"location":"plans/lightweight-chart-update-fix/#_2","title":"\u554f\u984c\u306e\u5185\u5bb9","text":""},{"location":"plans/lightweight-chart-update-fix/#_3","title":"\u73fe\u8c61","text":"<p>marimo \u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u3067\u4ee5\u4e0b\u306e\u9806\u5e8f\u3067\u30bb\u30eb\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30c1\u30e3\u30fc\u30c8\u304c\u66f4\u65b0\u3055\u308c\u306a\u3044\uff1a</p> <ol> <li><code>bt.chart(code=code)</code> \u3092\u5b9f\u884c \u2192 \u7a7a\u306e\u30c1\u30e3\u30fc\u30c8\u304c\u8868\u793a\u3055\u308c\u308b</li> <li><code>run()</code> \u3092\u5b9f\u884c \u2192 <code>step()</code> \u304c\u5b9f\u884c\u3055\u308c\u308b\u304c\u3001\u30c1\u30e3\u30fc\u30c8\u306f\u66f4\u65b0\u3055\u308c\u306a\u3044</li> <li>\u518d\u5ea6 <code>bt.chart(code=code)</code> \u3092\u5b9f\u884c \u2192 \u30c1\u30e3\u30fc\u30c8\u304c\u6b63\u3057\u304f\u8868\u793a\u3055\u308c\u308b</li> </ol> <p>\u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c: <code>run()</code> \u5b9f\u884c\u5f8c\u3001\u81ea\u52d5\u7684\u306b\u30c1\u30e3\u30fc\u30c8\u304c\u66f4\u65b0\u3055\u308c\u308b\u3079\u304d</p>"},{"location":"plans/lightweight-chart-update-fix/#_4","title":"\u8abf\u67fb\u3067\u308f\u304b\u3063\u305f\u3053\u3068","text":""},{"location":"plans/lightweight-chart-update-fix/#1-marimo","title":"1. marimo \u306e\u30bb\u30eb\u5b9f\u884c\u9806\u5e8f","text":"<p>marimo \u306f\u4f9d\u5b58\u95a2\u4fc2\u306b\u57fa\u3065\u3044\u3066\u30bb\u30eb\u3092\u4e26\u5217\u5b9f\u884c\u3059\u308b\u3002\u305d\u306e\u305f\u3081\uff1a</p> <ul> <li><code>Cell-5: bt.chart()</code> \u3068 <code>Cell-6: run()</code> \u304c\u540c\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b</li> <li><code>bt.chart()</code> \u304c\u5148\u306b\u5b8c\u4e86\u3057\u3001<code>run()</code> \u2192 <code>step()</code> \u304c\u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\u72b6\u614b</li> </ul>"},{"location":"plans/lightweight-chart-update-fix/#2-_data-_current_data","title":"2. <code>_data</code> \u3068 <code>_current_data</code> \u306e\u9055\u3044","text":"\u5909\u6570 \u8a2d\u5b9a\u30bf\u30a4\u30df\u30f3\u30b0 \u5185\u5bb9 <code>_data</code> <code>set_data()</code> \u5168\u671f\u9593\u306e\u682a\u4fa1\u30c7\u30fc\u30bf <code>_current_data</code> <code>step()</code> \u73fe\u5728\u30b9\u30c6\u30c3\u30d7\u307e\u3067\u306e\u30c7\u30fc\u30bf <p><code>step()</code> \u304c\u5b9f\u884c\u3055\u308c\u308b\u307e\u3067 <code>_current_data</code> \u306f\u7a7a\u306e\u307e\u307e\u3002</p>"},{"location":"plans/lightweight-chart-update-fix/#3-chart-early-return","title":"3. <code>chart()</code> \u306e EARLY RETURN \u554f\u984c","text":"<pre><code># \u4fee\u6b63\u524d\u306e\u30b3\u30fc\u30c9\nif code not in self._current_data or len(self._current_data[code]) == 0:\n    return LightweightChartWidget()  # \u7a7a\u306e\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u3092\u8fd4\u3059\uff08\u30ad\u30e3\u30c3\u30b7\u30e5\u767b\u9332\u306a\u3057\uff09\n</code></pre> <p>EARLY RETURN \u6642\u306b\u8fd4\u3055\u308c\u308b\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u306f <code>_chart_widgets</code> \u306b\u767b\u9332\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u3002</p>"},{"location":"plans/lightweight-chart-update-fix/#4-_update_all_charts","title":"4. <code>_update_all_charts()</code> \u306e\u52d5\u4f5c","text":"<pre><code>def _update_all_charts(self) -&gt; None:\n    for code, widget in self._chart_widgets.items():  # _chart_widgets \u304c\u7a7a\u306a\u3089\u4f55\u3082\u3057\u306a\u3044\n        self.update_chart(widget, code)\n</code></pre> <p><code>_chart_widgets</code> \u304c\u7a7a\u306e\u5834\u5408\u3001<code>step()</code> \u5f8c\u306e\u81ea\u52d5\u66f4\u65b0\u304c\u6a5f\u80fd\u3057\u306a\u3044\u3002</p>"},{"location":"plans/lightweight-chart-update-fix/#5","title":"5. \u521d\u671f\u72b6\u614b\u306e\u554f\u984c","text":"<pre><code>get_playing, set_playing = mo.state(True)  # \u521d\u671f\u5024\u304c True\n</code></pre> <p>\u8d77\u52d5\u6642\u306b <code>run()</code> \u304c\u547c\u3070\u308c\u308b\u3068\uff1a - <code>get_playing() == True</code> \u306a\u306e\u3067 <code>set_playing(False)</code> \u3059\u308b\u3060\u3051 - <code>_game_loop</code> \u306f\u958b\u59cb\u3055\u308c\u305a\u3001<code>step()</code> \u306f\u5b9f\u884c\u3055\u308c\u306a\u3044</p>"},{"location":"plans/lightweight-chart-update-fix/#_5","title":"\u554f\u984c\u306e\u6d41\u308c\uff08\u4fee\u6b63\u524d\uff09","text":"<pre><code>1. Cell-5: bt.chart(code) \u5b9f\u884c\n   \u2514\u2500 _current_data \u304c\u7a7a \u2192 EARLY RETURN\n   \u2514\u2500 \u7a7a\u306e\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u3092\u8fd4\u3059\uff08_chart_widgets \u306b\u767b\u9332\u3055\u308c\u306a\u3044\uff09\n\n2. Cell-6: run() \u5b9f\u884c\n   \u2514\u2500 get_playing() == True \u306a\u306e\u3067 set_playing(False) \u306e\u307f\n   \u2514\u2500 _game_loop \u306f\u958b\u59cb\u3055\u308c\u306a\u3044\n\n3. 2\u56de\u76ee\u306e run() \u5b9f\u884c\uff08\u30e6\u30fc\u30b6\u30fc\u64cd\u4f5c\uff09\n   \u2514\u2500 get_playing() == False \u306a\u306e\u3067 _game_loop \u958b\u59cb\n   \u2514\u2500 step() \u2192 _update_all_charts()\n   \u2514\u2500 _chart_widgets \u304c\u7a7a\u306a\u306e\u3067\u4f55\u3082\u66f4\u65b0\u3055\u308c\u306a\u3044\n\n4. Cell-5 \u518d\u5b9f\u884c\n   \u2514\u2500 _current_data \u306b\u30c7\u30fc\u30bf\u304c\u3042\u308b\n   \u2514\u2500 \u6b63\u3057\u3044\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u4f5c\u6210 \u2192 _chart_widgets \u306b\u767b\u9332\n   \u2514\u2500 \u30c1\u30e3\u30fc\u30c8\u304c\u8868\u793a\u3055\u308c\u308b\n</code></pre>"},{"location":"plans/lightweight-chart-update-fix/#_6","title":"\u65bd\u3057\u305f\u5bfe\u5fdc\u5185\u5bb9","text":""},{"location":"plans/lightweight-chart-update-fix/#backtestpy-chart","title":"\u4fee\u6b63\u7b87\u6240: <code>backtest.py</code> \u306e <code>chart()</code> \u30e1\u30bd\u30c3\u30c9","text":"<p>EARLY RETURN \u6642\u3082\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u3092 <code>_chart_widgets</code> \u306b\u767b\u9332\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\uff1a</p> <pre><code># \u4fee\u6b63\u5f8c\u306e\u30b3\u30fc\u30c9\nif not self._is_started or self._broker_instance is None:\n    from .api.chart import LightweightChartWidget\n    # \u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u767b\u9332\u3057\u3066\u5f8c\u304b\u3089\u66f4\u65b0\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n    if code not in self._chart_widgets:\n        self._chart_widgets[code] = LightweightChartWidget()\n    return self._chart_widgets[code]\n\nif code not in self._current_data or len(self._current_data[code]) == 0:\n    from .api.chart import LightweightChartWidget\n    # \u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u767b\u9332\u3057\u3066\u5f8c\u304b\u3089\u66f4\u65b0\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n    if code not in self._chart_widgets:\n        self._chart_widgets[code] = LightweightChartWidget()\n    return self._chart_widgets[code]\n</code></pre>"},{"location":"plans/lightweight-chart-update-fix/#_7","title":"\u4fee\u6b63\u5f8c\u306e\u6d41\u308c","text":"<pre><code>1. Cell-5: bt.chart(code) \u5b9f\u884c\n   \u2514\u2500 _current_data \u304c\u7a7a \u2192 EARLY RETURN\n   \u2514\u2500 \u7a7a\u306e\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u3092\u4f5c\u6210\u3057 _chart_widgets \u306b\u767b\u9332 \u2605\n   \u2514\u2500 \u540c\u3058\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u3092\u8fd4\u3059\n\n2. run() \u2192 step() \u2192 _update_all_charts()\n   \u2514\u2500 _chart_widgets['7203'] \u304c\u5b58\u5728\u3059\u308b \u2605\n   \u2514\u2500 update_chart() \u3067\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u3092\u66f4\u65b0\n   \u2514\u2500 \u540c\u3058\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306a\u306e\u3067 Cell-5 \u306e\u8868\u793a\u3082\u66f4\u65b0\u3055\u308c\u308b\n</code></pre>"},{"location":"plans/lightweight-chart-update-fix/#_8","title":"\u691c\u8a3c\u65b9\u6cd5","text":"<ol> <li>marimo \u3067 fintech1.py \u3092\u958b\u304f</li> <li>\u5168\u30bb\u30eb\u3092\u5b9f\u884c\uff08\u81ea\u52d5\u5b9f\u884c\uff09</li> <li>\u30c1\u30e3\u30fc\u30c8\u304c\u81ea\u52d5\u7684\u306b\u66f4\u65b0\u3055\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d</li> </ol>"},{"location":"plans/lightweight-chart-update-fix/#_9","title":"\u691c\u8a0e\u3057\u305f\u4ed6\u306e\u89e3\u6c7a\u7b56","text":"\u6848 \u5185\u5bb9 \u63a1\u7528 \u68481 EARLY RETURN \u3067\u3082\u30ad\u30e3\u30c3\u30b7\u30e5\u767b\u9332 \u2705 \u63a1\u7528 \u68482 Cell-5 \u3092 AutoRefresh \u306b\u4f9d\u5b58\u3055\u305b\u308b - \u68483 <code>mo.state(True)</code> \u3092 <code>mo.state(False)</code> \u306b\u5909\u66f4 - <p>\u68481 \u3092\u63a1\u7528\u3057\u305f\u7406\u7531\uff1a - backtest.py \u306e\u307f\u306e\u4fee\u6b63\u3067\u6e08\u3080 - \u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u5074\u306e\u5909\u66f4\u304c\u4e0d\u8981 - \u540c\u3058\u30a6\u30a3\u30b8\u30a7\u30c3\u30c8\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u518d\u5229\u7528\u3059\u308b\u305f\u3081\u3001marimo \u306e\u30ea\u30a2\u30af\u30c6\u30a3\u30d6\u30b7\u30b9\u30c6\u30e0\u3068\u6574\u5408\u6027\u304c\u3042\u308b</p>"},{"location":"plans/lightweight-chart-update-fix/#_10","title":"\u95a2\u9023\u30d5\u30a1\u30a4\u30eb","text":"<ul> <li><code>src/BackcastPro/backtest.py</code> - \u4fee\u6b63\u5bfe\u8c61</li> <li><code>src/BackcastPro/api/chart.py</code> - LightweightChartWidget \u306e\u5b9f\u88c5</li> <li>\u30b5\u30f3\u30d7\u30eb\u30ce\u30fc\u30c8\u30d6\u30c3\u30af: <code>C:\\Users\\sasai\\AppData\\Local\\Temp\\fintech1.py</code></li> </ul>"},{"location":"plans/lightweight-chart-update-fix/#_11","title":"\u4eca\u5f8c\u306e\u6ce8\u610f\u70b9","text":"<ol> <li><code>chart()</code> \u30e1\u30bd\u30c3\u30c9\u3092\u5909\u66f4\u3059\u308b\u969b\u306f\u3001EARLY RETURN \u30d1\u30b9\u3067\u3082\u30ad\u30e3\u30c3\u30b7\u30e5\u767b\u9332\u304c\u884c\u308f\u308c\u308b\u3053\u3068\u3092\u8003\u616e\u3059\u308b</li> <li><code>_chart_widgets</code> \u306e\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb\u306f <code>reset(clear_chart_cache=True)</code> \u3067\u30af\u30ea\u30a2\u3055\u308c\u308b</li> <li>marimo \u306e\u30bb\u30eb\u5b9f\u884c\u9806\u5e8f\u306f\u4f9d\u5b58\u95a2\u4fc2\u306b\u57fa\u3065\u304f\u305f\u3081\u3001<code>step()</code> \u524d\u306b <code>chart()</code> \u304c\u547c\u3070\u308c\u308b\u53ef\u80fd\u6027\u3092\u5e38\u306b\u8003\u616e\u3059\u308b</li> </ol>"},{"location":"plans/marimo-step-execution-plan/","title":"BackcastPro \u30ea\u30d7\u30ec\u30a4\u578b\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc \u5909\u66f4\u30d7\u30e9\u30f3","text":""},{"location":"plans/marimo-step-execution-plan/#_1","title":"\u6982\u8981","text":"<p>\u76ee\u7684: \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u7d50\u679c\u3067\u306f\u306a\u304f\u300c\u6226\u7565\u304c\u610f\u601d\u6c7a\u5b9a\u3057\u305f\u77ac\u9593\u306e\u30c1\u30e3\u30fc\u30c8\u4f53\u9a13\u300d\u3092\u63d0\u4f9b\u3059\u308b</p> <p>\u73fe\u5728\u306e <code>Backtest.run()</code> \u306f\u5168\u671f\u9593\u3092\u4e00\u62ec\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3060\u3051\u3092\u8fd4\u3059\u8a2d\u8a08\u3067\u3059\u3002 marimo \u3068\u9023\u643a\u3057\u3066\u3001**1\u30d0\u30fc\u305a\u3064\u6642\u9593\u3092\u9032\u3081\u306a\u304c\u3089\u30c1\u30e3\u30fc\u30c8\u3068\u58f2\u8cb7\u3092\u53ef\u8996\u5316**\u3067\u304d\u308b\u30ea\u30d7\u30ec\u30a4\u578b\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc\u306b\u5909\u66f4\u3057\u307e\u3059\u3002</p>"},{"location":"plans/marimo-step-execution-plan/#_2","title":"\u8a2d\u8a08\u6c7a\u5b9a\u4e8b\u9805","text":"<ul> <li>\u30c1\u30e3\u30fc\u30c8: plotly\uff08\u30ed\u30fc\u30bd\u30af\u8db3 + \u58f2\u8cb7\u30de\u30fc\u30ab\u30fc\uff09</li> <li>UI: \u30b9\u30e9\u30a4\u30c0\u30fc + \u518d\u751f\u30dc\u30bf\u30f3\u306e\u4e21\u65b9</li> <li>\u9298\u67c4: \u8907\u6570\u9298\u67c4\u5bfe\u5fdc</li> </ul>"},{"location":"plans/marimo-step-execution-plan/#1","title":"1. \u306a\u305c\u65e2\u5b58\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u304c\u5206\u304b\u308a\u306b\u304f\u3044\u304b","text":"<pre><code>\u5f93\u6765\u306e\u30d0\u30c3\u30af\u30c6\u30b9\u30c8:\n  for bar in all_bars:     \u2190 \u4e00\u6c17\u306b\u6d88\u5316\n      strategy.next()\n  return results           \u2190 \u7d50\u679c\u3060\u3051\n\n\u554f\u984c\u70b9:\n  \u300c\u5224\u65ad\u3057\u305f\u77ac\u9593\u306e\u30c1\u30e3\u30fc\u30c8\u6587\u8108\u300d\u304c\u5b8c\u5168\u306b\u5931\u308f\u308c\u308b\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#2","title":"2. \u76ee\u6a19\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3","text":"<pre><code>[ \u5168OHLC\u30c7\u30fc\u30bf (dict[code, DataFrame]) ]\n                |\n                v\n[ \u73fe\u5728\u306eindex (t) ] \u2190 marimo UI \u304c\u5236\u5fa1\uff08\u30b9\u30e9\u30a4\u30c0\u30fc / \u518d\u751f\u30dc\u30bf\u30f3\uff09\n                |\n                v\n[ data[:t] ] \u2192 \u30c1\u30e3\u30fc\u30c8\u63cf\u753b\uff08plotly\uff09\n                |\n                v\n[ strategy(bt) ] \u2192 \u58f2\u8cb7\u5224\u65ad\uff08bt.buy() / bt.sell()\uff09\n                |\n                v\n[ trades / position / cash / equity ]\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#3","title":"3. \u7d04\u5b9a\u30bf\u30a4\u30df\u30f3\u30b0\u30e2\u30c7\u30eb\uff08\u91cd\u8981\uff09","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u6642\u9593\u8ef8: ... \u2502 t-2 \u2502 t-1 \u2502  t  \u2502 t+1 \u2502 ...                 \u2502\n\u2502              \u2502     \u2502     \u2502     \u2502     \u2502                     \u2502\n\u2502  step(t)\u5b9f\u884c\u6642:                                            \u2502\n\u2502    1. data[:t] \u304c\u78ba\u5b9a\uff08t \u306e OHLC \u304c\u898b\u3048\u308b\uff09               \u2502\n\u2502    2. strategy(bt) \u304c\u547c\u3070\u308c\u308b                              \u2502\n\u2502       \u2192 t \u306e Close \u307e\u3067\u898b\u3066\u5224\u65ad                           \u2502\n\u2502    3. buy()/sell() \u3067\u6ce8\u6587\u3092\u767a\u884c                           \u2502\n\u2502    4. bt.step() \u3067 broker.next(t) \u304c\u5b9f\u884c                  \u2502\n\u2502       \u2192 \u6ce8\u6587\u306f t \u306e\u4fa1\u683c\u3067\u7d04\u5b9a\uff08trade_on_close=True\u6642\uff09    \u2502\n\u2502       \u2192 \u307e\u305f\u306f t+1 \u306e Open \u3067\u7d04\u5b9a\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u3010\u30eb\u30fc\u30eb\u3011\n- strategy \u306f\u300c\u78ba\u5b9a\u8db3\uff08t\uff09\u307e\u3067\u300d\u3092\u898b\u3066\u5224\u65ad\u3059\u308b\n- \u6ce8\u6587\u306f step() \u5185\u3067\u51e6\u7406\u3055\u308c\u308b\n- trade_on_close=False\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09: \u6b21\u8db3\u59cb\u5024\u3067\u7d04\u5b9a\n- trade_on_close=True: \u73fe\u5728\u8db3\u7d42\u5024\u3067\u7d04\u5b9a\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#4","title":"4. \u76ee\u6a19\u306e\u4f7f\u7528\u30a4\u30e1\u30fc\u30b8","text":""},{"location":"plans/marimo-step-execution-plan/#41","title":"4.1 \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<pre><code>import marimo as mo\nfrom BackcastPro import Backtest\n\n# \u30c7\u30fc\u30bf\u6e96\u5099\uff08\u8907\u6570\u9298\u67c4\u5bfe\u5fdc\uff09\nbt = Backtest(\n    data={\"AAPL\": df_aapl, \"GOOG\": df_goog},\n    cash=100000\n)\n\n# \u6226\u7565\u95a2\u6570\uff08\u5916\u90e8\u3067\u5b9a\u7fa9\uff09\ndef my_strategy(bt):\n    # \u26a0\ufe0f \u8907\u6570\u9298\u67c4\u6642\u306f position_of() \u3092\u4f7f\u3046\n    df = bt.data[\"AAPL\"]\n    if len(df) &lt; 2:\n        return\n\n    c0 = df[\"Close\"].iloc[-2]\n    c1 = df[\"Close\"].iloc[-1]\n\n    pos = bt.position_of(\"AAPL\")  # \u2190 position \u3067\u306f\u306a\u304f position_of \u3092\u4f7f\u7528\n\n    if pos == 0 and c1 &lt; c0:\n        bt.buy(code=\"AAPL\", tag=\"dip_buy\")  # tag \u3067\u7406\u7531\u3092\u8a18\u9332\n    elif pos &gt; 0 and c1 &gt; c0:\n        bt.sell(code=\"AAPL\", tag=\"profit_take\")\n\n# 1\u30b9\u30c6\u30c3\u30d7\u9032\u3081\u308b\ndef step(bt):\n    my_strategy(bt)\n    bt.step()\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#42-marimo-ui","title":"4.2 marimo UI\u3068\u306e\u9023\u643a\uff08\u30b9\u30e9\u30a4\u30c0\u30fc\u4e3b\u4f53\uff09","text":"<pre><code># \u6642\u9593\u5236\u5fa1\u30b9\u30e9\u30a4\u30c0\u30fc\nslider = mo.ui.slider(\n    start=1,\n    stop=len(bt.index),\n    value=1,\n    label=\"\u6642\u9593\"\n)\n\n# \u30b9\u30e9\u30a4\u30c0\u30fc\u5024\u306b\u5fdc\u3058\u3066\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3092\u9032\u3081\u308b\uff08\u6226\u7565\u4ed8\u304d\uff09\nbt.goto(slider.value, strategy=my_strategy)\n\n# \u30c1\u30e3\u30fc\u30c8\u63cf\u753b\nchart = bt.chart(code=\"AAPL\")\nmo.vstack([slider, chart])\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#43-marimo-ui","title":"4.3 marimo UI\u3068\u306e\u9023\u643a\uff08\u81ea\u52d5\u518d\u751f\uff09","text":"<pre><code># \u518d\u751f\u72b6\u614b\nis_playing, set_playing = mo.state(False)\n\n# \u73fe\u5728\u4f4d\u7f6e\uff08slider \u3068\u306f\u72ec\u7acb\uff09\ncurrent_step, set_step = mo.state(1)\n\n# \u518d\u751f/\u505c\u6b62\u30dc\u30bf\u30f3\nplay_btn = mo.ui.button(\n    label=\"\u25b6 \u518d\u751f\" if not is_playing else \"\u23f8 \u505c\u6b62\",\n    on_click=lambda _: set_playing(not is_playing)\n)\n\n# \u81ea\u52d5\u518d\u751f\uff08slider \u306f\u540c\u671f\u3055\u305b\u306a\u3044\uff09\ndef auto_advance(_):\n    if is_playing and current_step &lt; len(bt.index):\n        bt.goto(current_step + 1, strategy=my_strategy)\n        set_step(current_step + 1)\n\nrefresh = mo.ui.refresh(\n    default_interval=\"500ms\",\n    on_change=auto_advance\n)\n\n# \u73fe\u5728\u4f4d\u7f6e\u306e\u8868\u793a\uff08slider \u3067\u306f\u306a\u304f\u30c6\u30ad\u30b9\u30c8\uff09\nmo.md(f\"**Step: {current_step} / {len(bt.index)}**\")\n\nmo.vstack([\n    mo.hstack([play_btn, slider]),\n    chart,\n    refresh if is_playing else None\n])\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#5-backtest","title":"5. Backtest \u30af\u30e9\u30b9\u306e\u5909\u66f4\u5185\u5bb9","text":""},{"location":"plans/marimo-step-execution-plan/#51-__init__","title":"5.1 <code>__init__</code> \u306e\u5909\u66f4","text":"<pre><code>import sys\nfrom typing import Optional, Tuple, Union, List, Callable\nimport numpy as np\nimport pandas as pd\nimport plotly.graph_objects as go\n\nclass Backtest:\n    def __init__(self,\n                data: dict[str, pd.DataFrame] = None,\n                *,\n                cash: float = 10_000,\n                spread: float = .0,\n                commission: Union[float, Tuple[float, float]] = .0,\n                margin: float = 1.,\n                trade_on_close=False,\n                hedging=False,\n                exclusive_orders=False,\n                finalize_trades=False,\n                ):\n        # strategy \u5f15\u6570\u3092\u524a\u9664\n\n        # \u65e2\u5b58\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3...\n        self.set_data(data)\n\n        self._broker_factory = partial(\n            _Broker, cash=cash, spread=spread, commission=commission,\n            margin=margin, trade_on_close=trade_on_close, hedging=hedging,\n            exclusive_orders=exclusive_orders\n        )\n\n        # \u30b9\u30c6\u30c3\u30d7\u5b9f\u884c\u7528\u306e\u72b6\u614b\u7ba1\u7406\n        self._broker_instance: Optional[_Broker] = None\n        self._step_index = 0\n        self._is_started = False\n        self._is_finished = False\n        self._current_data: dict[str, pd.DataFrame] = {}\n        self._results: Optional[pd.Series] = None\n        self._finalize_trades = bool(finalize_trades)\n\n        # \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316: \u5404\u9298\u67c4\u306e index position \u30de\u30c3\u30d4\u30f3\u30b0\n        self._index_positions: dict[str, dict] = {}\n\n        # \u81ea\u52d5\u7684\u306bstart()\u3092\u547c\u3073\u51fa\u3059\n        if data is not None:\n            self.start()\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#52-start","title":"5.2 <code>start()</code> \u30e1\u30bd\u30c3\u30c9","text":"<pre><code>def start(self) -&gt; 'Backtest':\n    \"\"\"\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3092\u958b\u59cb\u6e96\u5099\u3059\u308b\"\"\"\n    if self._data is None:\n        raise ValueError(\"data \u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\")\n\n    self._broker_instance = self._broker_factory(data=self._data)\n    self._step_index = 0\n    self._is_started = True\n    self._is_finished = False\n    self._current_data = {}\n    self._results = None\n\n    # \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316: \u5404\u9298\u67c4\u306e index \u2192 position \u30de\u30c3\u30d4\u30f3\u30b0\u3092\u4e8b\u524d\u8a08\u7b97\n    self._index_positions = {}\n    for code, df in self._data.items():\n        self._index_positions[code] = {\n            ts: i for i, ts in enumerate(df.index)\n        }\n\n    return self\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#53-step","title":"5.3 <code>step()</code> \u30e1\u30bd\u30c3\u30c9\uff08\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316\u7248\uff09","text":"<pre><code>def step(self) -&gt; bool:\n    \"\"\"\n    1\u30b9\u30c6\u30c3\u30d7\uff081\u30d0\u30fc\uff09\u9032\u3081\u308b\u3002\n\n    \u3010\u30bf\u30a4\u30df\u30f3\u30b0\u3011\n    - step(t) \u5b9f\u884c\u6642\u3001data[:t] \u304c\u898b\u3048\u308b\u72b6\u614b\u306b\u306a\u308b\n    - \u6ce8\u6587\u306f broker.next(t) \u5185\u3067\u51e6\u7406\u3055\u308c\u308b\n    \"\"\"\n    if not self._is_started:\n        raise RuntimeError(\"start() \u3092\u547c\u3073\u51fa\u3057\u3066\u304f\u3060\u3055\u3044\")\n\n    if self._is_finished:\n        return False\n\n    if self._step_index &gt;= len(self.index):\n        self._is_finished = True\n        return False\n\n    current_time = self.index[self._step_index]\n\n    with np.errstate(invalid='ignore'):\n        # \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316: iloc \u30d9\u30fc\u30b9\u3067 slicing\n        for code, df in self._data.items():\n            if current_time in self._index_positions[code]:\n                pos = self._index_positions[code][current_time]\n                self._current_data[code] = df.iloc[:pos + 1]\n            # current_time \u304c\u3053\u306e\u9298\u67c4\u306b\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u524d\u306e\u72b6\u614b\u3092\u7dad\u6301\n\n        # \u30d6\u30ed\u30fc\u30ab\u30fc\u51e6\u7406\uff08\u6ce8\u6587\u306e\u7d04\u5b9a\uff09\n        try:\n            self._broker_instance._data = self._current_data\n            self._broker_instance.next(current_time)\n        except Exception:\n            self._is_finished = True\n            return False\n\n    self._step_index += 1\n\n    if self._step_index &gt;= len(self.index):\n        self._is_finished = True\n\n    return not self._is_finished\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#54-goto","title":"5.4 <code>goto()</code> \u30e1\u30bd\u30c3\u30c9\uff08\u6226\u7565\u4ed8\u304d\u5bfe\u5fdc\uff09","text":"<pre><code>def goto(self, step: int, strategy: Callable[['Backtest'], None] = None) -&gt; 'Backtest':\n    \"\"\"\n    \u6307\u5b9a\u30b9\u30c6\u30c3\u30d7\u307e\u3067\u9032\u3081\u308b\uff08\u30b9\u30e9\u30a4\u30c0\u30fc\u9023\u643a\u7528\uff09\n\n    Args:\n        step: \u76ee\u6a19\u306e\u30b9\u30c6\u30c3\u30d7\u756a\u53f7\uff081-indexed\uff09\n        strategy: \u5404\u30b9\u30c6\u30c3\u30d7\u3067\u547c\u3073\u51fa\u3059\u6226\u7565\u95a2\u6570\uff08\u7701\u7565\u53ef\uff09\n    \"\"\"\n    step = max(1, min(step, len(self.index)))\n\n    # \u73fe\u5728\u3088\u308a\u524d\u306b\u623b\u308b\u5834\u5408\u306f\u30ea\u30bb\u30c3\u30c8\n    if step &lt; self._step_index:\n        self.reset()\n\n    # \u76ee\u6a19\u307e\u3067\u9032\u3081\u308b\uff08\u6226\u7565\u3092\u9069\u7528\u3057\u306a\u304c\u3089\uff09\n    while self._step_index &lt; step and not self._is_finished:\n        if strategy:\n            strategy(self)\n        self.step()\n\n    return self\n\ndef reset(self) -&gt; 'Backtest':\n    \"\"\"\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3092\u30ea\u30bb\u30c3\u30c8\u3057\u3066\u6700\u521d\u304b\u3089\"\"\"\n    self._broker_instance = self._broker_factory(data=self._data)\n    self._step_index = 0\n    self._is_finished = False\n    self._current_data = {}\n    return self\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#55-buy-sell-tag","title":"5.5 <code>buy()</code> / <code>sell()</code> \u30e1\u30bd\u30c3\u30c9\uff08tag \u5bfe\u5fdc\uff09","text":"<pre><code>def buy(self, *,\n        code: str = None,\n        size: float = None,\n        limit: Optional[float] = None,\n        stop: Optional[float] = None,\n        sl: Optional[float] = None,\n        tp: Optional[float] = None,\n        tag: object = None) -&gt; 'Order':\n    \"\"\"\n    \u8cb7\u3044\u6ce8\u6587\u3092\u767a\u6ce8\u3059\u308b\u3002\n\n    Args:\n        code: \u9298\u67c4\u30b3\u30fc\u30c9\uff081\u9298\u67c4\u306e\u307f\u306e\u5834\u5408\u306f\u7701\u7565\u53ef\uff09\n        size: \u6ce8\u6587\u6570\u91cf\uff08\u7701\u7565\u6642\u306f\u5229\u7528\u53ef\u80fd\u8cc7\u91d1\u306e99.99%\uff09\n        tag: \u6ce8\u6587\u7406\u7531\uff08\u4f8b: \"dip_buy\", \"breakout\"\uff09\u2192 \u30c1\u30e3\u30fc\u30c8\u306b\u8868\u793a\u53ef\u80fd\n    \"\"\"\n    if not self._is_started:\n        raise RuntimeError(\"start() \u3092\u547c\u3073\u51fa\u3057\u3066\u304f\u3060\u3055\u3044\")\n\n    if code is None:\n        if len(self._data) == 1:\n            code = list(self._data.keys())[0]\n        else:\n            raise ValueError(\"\u8907\u6570\u9298\u67c4\u304c\u3042\u308b\u5834\u5408\u306fcode\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\")\n\n    if size is None:\n        size = 1 - sys.float_info.epsilon\n\n    return self._broker_instance.new_order(code, size, limit, stop, sl, tp, tag)\n\ndef sell(self, *,\n         code: str = None,\n         size: float = None,\n         limit: Optional[float] = None,\n         stop: Optional[float] = None,\n         sl: Optional[float] = None,\n         tp: Optional[float] = None,\n         tag: object = None) -&gt; 'Order':\n    \"\"\"\u58f2\u308a\u6ce8\u6587\u3092\u767a\u6ce8\u3059\u308b\"\"\"\n    if not self._is_started:\n        raise RuntimeError(\"start() \u3092\u547c\u3073\u51fa\u3057\u3066\u304f\u3060\u3055\u3044\")\n\n    if code is None:\n        if len(self._data) == 1:\n            code = list(self._data.keys())[0]\n        else:\n            raise ValueError(\"\u8907\u6570\u9298\u67c4\u304c\u3042\u308b\u5834\u5408\u306fcode\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\")\n\n    if size is None:\n        size = 1 - sys.float_info.epsilon\n\n    return self._broker_instance.new_order(code, -size, limit, stop, sl, tp, tag)\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#56-chart-tag","title":"5.6 <code>chart()</code> \u30e1\u30bd\u30c3\u30c9\uff08tag \u8868\u793a\u5bfe\u5fdc\uff09","text":"<pre><code>def chart(self, code: str = None, height: int = 500, show_tags: bool = True) -&gt; go.Figure:\n    \"\"\"\n    \u73fe\u5728\u6642\u70b9\u307e\u3067\u306e\u30ed\u30fc\u30bd\u30af\u8db3\u30c1\u30e3\u30fc\u30c8\u3092\u751f\u6210\uff08\u58f2\u8cb7\u30de\u30fc\u30ab\u30fc\u4ed8\u304d\uff09\n\n    Args:\n        code: \u9298\u67c4\u30b3\u30fc\u30c9\n        height: \u30c1\u30e3\u30fc\u30c8\u306e\u9ad8\u3055\n        show_tags: \u58f2\u8cb7\u7406\u7531\uff08tag\uff09\u3092\u30c1\u30e3\u30fc\u30c8\u306b\u8868\u793a\u3059\u308b\u304b\n    \"\"\"\n    if code is None:\n        if len(self._data) == 1:\n            code = list(self._data.keys())[0]\n        else:\n            raise ValueError(\"\u8907\u6570\u9298\u67c4\u304c\u3042\u308b\u5834\u5408\u306fcode\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\")\n\n    if code not in self._current_data or len(self._current_data[code]) == 0:\n        return go.Figure()\n\n    df = self._current_data[code]\n\n    fig = go.Figure()\n\n    # \u30ed\u30fc\u30bd\u30af\u8db3\n    fig.add_trace(go.Candlestick(\n        x=df.index,\n        open=df[\"Open\"],\n        high=df[\"High\"],\n        low=df[\"Low\"],\n        close=df[\"Close\"],\n        name=code\n    ))\n\n    # \u58f2\u8cb7\u30de\u30fc\u30ab\u30fc\n    for trade in self._broker_instance.closed_trades + self._broker_instance.trades:\n        if trade.code != code:\n            continue\n\n        is_long = trade.size &gt; 0\n\n        # \u30a8\u30f3\u30c8\u30ea\u30fc\u30de\u30fc\u30ab\u30fc\n        hover_text = f\"{'BUY' if is_long else 'SELL'}&lt;br&gt;Price: {trade.entry_price:.2f}\"\n        if show_tags and trade.tag:\n            hover_text += f\"&lt;br&gt;Reason: {trade.tag}\"\n\n        fig.add_trace(go.Scatter(\n            x=[trade.entry_time],\n            y=[trade.entry_price],\n            mode=\"markers+text\" if show_tags and trade.tag else \"markers\",\n            marker=dict(\n                color=\"green\" if is_long else \"red\",\n                size=12,\n                symbol=\"triangle-up\" if is_long else \"triangle-down\",\n            ),\n            text=[trade.tag] if show_tags and trade.tag else None,\n            textposition=\"top center\" if is_long else \"bottom center\",\n            textfont=dict(size=10),\n            hovertext=hover_text,\n            hoverinfo=\"text\",\n            name=\"BUY\" if is_long else \"SELL\",\n            showlegend=False\n        ))\n\n        # \u30a4\u30b0\u30b8\u30c3\u30c8\u30de\u30fc\u30ab\u30fc\uff08\u6c7a\u6e08\u6e08\u307f\u306e\u5834\u5408\uff09\n        if trade.exit_time is not None:\n            pnl = (trade.exit_price - trade.entry_price) * trade.size\n            fig.add_trace(go.Scatter(\n                x=[trade.exit_time],\n                y=[trade.exit_price],\n                mode=\"markers\",\n                marker=dict(\n                    color=\"blue\",\n                    size=10,\n                    symbol=\"x\",\n                ),\n                hovertext=f\"EXIT&lt;br&gt;Price: {trade.exit_price:.2f}&lt;br&gt;PnL: {pnl:+.2f}\",\n                hoverinfo=\"text\",\n                name=\"EXIT\",\n                showlegend=False\n            ))\n\n    fig.update_layout(\n        title=f\"{code} - {self.current_time}\",\n        xaxis_title=\"Date\",\n        yaxis_title=\"Price\",\n        height=height,\n        xaxis_rangeslider_visible=False,\n    )\n\n    return fig\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#57","title":"5.7 \u30d7\u30ed\u30d1\u30c6\u30a3","text":"<pre><code>@property\ndef data(self) -&gt; dict[str, pd.DataFrame]:\n    \"\"\"\u73fe\u5728\u6642\u70b9\u307e\u3067\u306e\u30c7\u30fc\u30bf\"\"\"\n    return self._current_data\n\n@property\ndef position(self) -&gt; int:\n    \"\"\"\n    \u73fe\u5728\u306e\u30dd\u30b8\u30b7\u30e7\u30f3\u30b5\u30a4\u30ba\uff08\u5168\u9298\u67c4\u5408\u8a08\uff09\n\n    \u26a0\ufe0f \u6ce8\u610f: \u8907\u6570\u9298\u67c4\u3092\u6271\u3046\u5834\u5408\u306f position_of(code) \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n    \u3053\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306f\u5f8c\u65b9\u4e92\u63db\u6027\u306e\u305f\u3081\u306b\u6b8b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n    \"\"\"\n    if not self._is_started or self._broker_instance is None:\n        return 0\n    return self._broker_instance.position.size\n\ndef position_of(self, code: str) -&gt; int:\n    \"\"\"\n    \u6307\u5b9a\u9298\u67c4\u306e\u30dd\u30b8\u30b7\u30e7\u30f3\u30b5\u30a4\u30ba\uff08\u63a8\u5968\uff09\n\n    Args:\n        code: \u9298\u67c4\u30b3\u30fc\u30c9\n\n    Returns:\n        int: \u30dd\u30b8\u30b7\u30e7\u30f3\u30b5\u30a4\u30ba\uff08\u6b63: \u30ed\u30f3\u30b0\u3001\u8ca0: \u30b7\u30e7\u30fc\u30c8\u30010: \u30ce\u30fc\u30dd\u30b8\uff09\n    \"\"\"\n    if not self._is_started or self._broker_instance is None:\n        return 0\n    return sum(t.size for t in self._broker_instance.trades if t.code == code)\n\n@property\ndef equity(self) -&gt; float:\n    \"\"\"\u73fe\u5728\u306e\u8cc7\u7523\"\"\"\n    if not self._is_started or self._broker_instance is None:\n        return self._broker_factory.keywords.get('cash', 0)\n    return self._broker_instance.equity\n\n@property\ndef cash(self) -&gt; float:\n    \"\"\"\u73fe\u5728\u306e\u73fe\u91d1\u6b8b\u9ad8\"\"\"\n    if not self._is_started or self._broker_instance is None:\n        return self._broker_factory.keywords.get('cash', 0)\n    return self._broker_instance.cash\n\n@property\ndef is_finished(self) -&gt; bool:\n    \"\"\"\u5b8c\u4e86\u3057\u305f\u304b\u3069\u3046\u304b\"\"\"\n    return self._is_finished\n\n@property\ndef current_time(self) -&gt; pd.Timestamp:\n    \"\"\"\u73fe\u5728\u306e\u65e5\u6642\"\"\"\n    if self._step_index == 0:\n        return None\n    return self.index[self._step_index - 1]\n\n@property\ndef progress(self) -&gt; float:\n    \"\"\"\u9032\u6357\u7387\uff080.0\u301c1.0\uff09\"\"\"\n    if len(self.index) == 0:\n        return 0.0\n    return self._step_index / len(self.index)\n\n@property\ndef trades(self) -&gt; list:\n    \"\"\"\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u53d6\u5f15\u30ea\u30b9\u30c8\"\"\"\n    if not self._is_started or self._broker_instance is None:\n        return []\n    return list(self._broker_instance.trades)\n\n@property\ndef closed_trades(self) -&gt; list:\n    \"\"\"\u6c7a\u6e08\u6e08\u307f\u53d6\u5f15\u30ea\u30b9\u30c8\"\"\"\n    if not self._is_started or self._broker_instance is None:\n        return []\n    return list(self._broker_instance.closed_trades)\n\n@property\ndef orders(self) -&gt; list:\n    \"\"\"\u672a\u7d04\u5b9a\u306e\u6ce8\u6587\u30ea\u30b9\u30c8\"\"\"\n    if not self._is_started or self._broker_instance is None:\n        return []\n    return list(self._broker_instance.orders)\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#58-finalize-run","title":"5.8 <code>finalize()</code> \u3068 <code>run()</code> \u30e1\u30bd\u30c3\u30c9","text":"<pre><code>def finalize(self) -&gt; pd.Series:\n    \"\"\"\u7d71\u8a08\u3092\u8a08\u7b97\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059\"\"\"\n    if self._results is not None:\n        return self._results\n\n    if not self._is_started:\n        raise RuntimeError(\"\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u304c\u958b\u59cb\u3055\u308c\u3066\u3044\u307e\u305b\u3093\")\n\n    broker = self._broker_instance\n\n    if self._finalize_trades:\n        for trade in reversed(broker.trades):\n            trade.close()\n        if self._step_index &gt; 0:\n            broker.next(self.index[self._step_index - 1])\n\n    equity = pd.Series(broker._equity).bfill().fillna(broker._cash).values\n    self._results = compute_stats(\n        trades=broker.closed_trades,\n        equity=np.array(equity),\n        index=self.index[:self._step_index],\n        strategy_instance=None,\n        risk_free_rate=0.0,\n    )\n\n    return self._results\n\ndef run(self, strategy_func: Callable[['Backtest'], None] = None) -&gt; pd.Series:\n    \"\"\"\n    \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u3092\u6700\u5f8c\u307e\u3067\u5b9f\u884c\uff08\u5f93\u6765\u4e92\u63db\uff09\n\n    Args:\n        strategy_func: \u5404\u30b9\u30c6\u30c3\u30d7\u3067\u547c\u3073\u51fa\u3059\u95a2\u6570 (bt) -&gt; None\n    \"\"\"\n    if not self._is_started:\n        self.start()\n\n    while not self._is_finished:\n        if strategy_func:\n            strategy_func(self)\n        self.step()\n\n    return self.finalize()\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#6-marimo","title":"6. \u5b8c\u5168\u306amarimo\u9023\u643a\u30b5\u30f3\u30d7\u30eb","text":"<pre><code>import marimo as mo\nimport pandas as pd\nfrom BackcastPro import Backtest\n\n# === \u30bb\u30eb1: \u30c7\u30fc\u30bf\u6e96\u5099 ===\ndf_aapl = pd.read_csv(\"AAPL.csv\", index_col=0, parse_dates=True)\ndf_goog = pd.read_csv(\"GOOG.csv\", index_col=0, parse_dates=True)\n\nbt = Backtest(\n    data={\"AAPL\": df_aapl, \"GOOG\": df_goog},\n    cash=100000\n)\n\n# === \u30bb\u30eb2: \u6226\u7565\u5b9a\u7fa9 ===\ndef my_strategy(bt):\n    \"\"\"\n    \u30b7\u30f3\u30d7\u30eb\u306a\u6226\u7565: \u524d\u65e5\u6bd4\u4e0b\u843d\u3067\u8cb7\u3044\u3001\u4e0a\u6607\u3067\u58f2\u308a\n\n    \u3010\u30bf\u30a4\u30df\u30f3\u30b0\u3011\n    - bt.data \u306b\u306f current_time \u307e\u3067\u306e\u78ba\u5b9a\u8db3\u304c\u5165\u3063\u3066\u3044\u308b\n    - buy()/sell() \u306e\u6ce8\u6587\u306f\u6b21\u306e step() \u3067\u51e6\u7406\u3055\u308c\u308b\n    \"\"\"\n    df = bt.data.get(\"AAPL\")\n    if df is None or len(df) &lt; 2:\n        return\n\n    c0 = df[\"Close\"].iloc[-2]\n    c1 = df[\"Close\"].iloc[-1]\n\n    # \u26a0\ufe0f \u8907\u6570\u9298\u67c4\u6642\u306f position \u3067\u306f\u306a\u304f position_of \u3092\u4f7f\u3046\n    pos = bt.position_of(\"AAPL\")\n\n    if pos == 0 and c1 &lt; c0:\n        bt.buy(code=\"AAPL\", tag=\"dip_buy\")\n    elif pos &gt; 0 and c1 &gt; c0:\n        bt.sell(code=\"AAPL\", tag=\"profit_take\")\n\n# === \u30bb\u30eb3: UI \u30b3\u30f3\u30c8\u30ed\u30fc\u30eb ===\n# \u6642\u9593\u30b9\u30e9\u30a4\u30c0\u30fc\nslider = mo.ui.slider(\n    start=1,\n    stop=len(bt.index),\n    value=1,\n    label=\"\ud83d\udcc5 \u6642\u9593\",\n    show_value=True\n)\n\n# \u9298\u67c4\u9078\u629e\nstock_select = mo.ui.dropdown(\n    options=list(bt._data.keys()),\n    value=list(bt._data.keys())[0],\n    label=\"\ud83d\udcc8 \u9298\u67c4\"\n)\n\nmo.hstack([slider, stock_select])\n\n# === \u30bb\u30eb4: \u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u5b9f\u884c &amp; \u30c1\u30e3\u30fc\u30c8 ===\n# \u30b9\u30e9\u30a4\u30c0\u30fc\u4f4d\u7f6e\u307e\u3067\u9032\u3081\u308b\uff08\u6226\u7565\u3092\u9069\u7528\u3057\u306a\u304c\u3089\uff09\nbt.goto(slider.value, strategy=my_strategy)\n\n# \u30c1\u30e3\u30fc\u30c8\u63cf\u753b\uff08tag \u8868\u793a\u4ed8\u304d\uff09\nchart = bt.chart(code=stock_select.value, height=500, show_tags=True)\n\n# \u60c5\u5831\u30d1\u30cd\u30eb\ninfo = mo.md(f\"\"\"\n### \ud83d\udcca \u72b6\u6cc1\n| \u9805\u76ee | \u5024 |\n|------|-----|\n| \u65e5\u6642 | {bt.current_time} |\n| \u9032\u6357 | {bt.progress * 100:.1f}% ({bt._step_index}/{len(bt.index)}) |\n| \u8cc7\u7523 | ${bt.equity:,.2f} |\n| \u73fe\u91d1 | ${bt.cash:,.2f} |\n| \u30dd\u30b8\u30b7\u30e7\u30f3({stock_select.value}) | {bt.position_of(stock_select.value)} \u682a |\n| \u6c7a\u6e08\u6e08\u53d6\u5f15 | {len(bt.closed_trades)} \u4ef6 |\n\"\"\")\n\nmo.vstack([chart, info])\n\n# === \u30bb\u30eb5: \u81ea\u52d5\u518d\u751f\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09 ===\nis_playing, set_playing = mo.state(False)\n\nplay_btn = mo.ui.button(\n    label=\"\u25b6 \u518d\u751f\" if not is_playing else \"\u23f8 \u505c\u6b62\",\n    on_click=lambda _: set_playing(not is_playing)\n)\n\n# \u6ce8\u610f: \u81ea\u52d5\u518d\u751f\u4e2d\u306f slider \u3068\u306f\u72ec\u7acb\u3057\u3066\u9032\u3080\n# slider \u306f\u300c\u4efb\u610f\u306e\u4f4d\u7f6e\u306b\u30b8\u30e3\u30f3\u30d7\u300d\u7528\u3068\u3057\u3066\u6b8b\u3059\n\nplay_btn\n</code></pre>"},{"location":"plans/marimo-step-execution-plan/#7","title":"7. \u5b9f\u88c5\u306e\u512a\u5148\u9806\u4f4d","text":""},{"location":"plans/marimo-step-execution-plan/#phase-1","title":"Phase 1: \u6700\u5c0f\u5b9f\u88c5\uff08\u5fc5\u9808\uff09","text":"<ul> <li> <code>start()</code>, <code>step()</code>, <code>reset()</code> \u30e1\u30bd\u30c3\u30c9</li> <li> <code>buy()</code>, <code>sell()</code> \u30e1\u30bd\u30c3\u30c9\uff08tag \u5bfe\u5fdc\uff09</li> <li> <code>data</code>, <code>position</code>, <code>position_of()</code>, <code>equity</code>, <code>current_time</code> \u30d7\u30ed\u30d1\u30c6\u30a3</li> <li> <code>is_finished</code>, <code>progress</code> \u30d7\u30ed\u30d1\u30c6\u30a3</li> <li> \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316\uff08iloc \u30d9\u30fc\u30b9 slicing\uff09</li> </ul>"},{"location":"plans/marimo-step-execution-plan/#phase-2","title":"Phase 2: \u53ef\u8996\u5316\uff08\u5fc5\u9808\uff09","text":"<ul> <li> <code>chart()</code> \u30e1\u30bd\u30c3\u30c9\uff08plotly + tag \u8868\u793a\uff09</li> <li> <code>goto()</code> \u30e1\u30bd\u30c3\u30c9\uff08strategy \u5f15\u6570\u5bfe\u5fdc\uff09</li> </ul>"},{"location":"plans/marimo-step-execution-plan/#phase-3","title":"Phase 3: \u4e92\u63db\u6027","text":"<ul> <li> <code>run()</code> \u30e1\u30bd\u30c3\u30c9\uff08\u5f93\u6765\u306e\u4e00\u62ec\u5b9f\u884c\uff09</li> <li> <code>finalize()</code> \u30e1\u30bd\u30c3\u30c9\uff08\u7d71\u8a08\u8a08\u7b97\uff09</li> </ul>"},{"location":"plans/marimo-step-execution-plan/#8","title":"8. \u30d5\u30a1\u30a4\u30eb\u5909\u66f4\u4e00\u89a7","text":"\u30d5\u30a1\u30a4\u30eb \u5909\u66f4\u5185\u5bb9 <code>src/BackcastPro/backtest.py</code> <code>__init__</code>\u5909\u66f4\u3001\u65b0\u30e1\u30bd\u30c3\u30c9\u7fa4\u306e\u8ffd\u52a0 <code>tests/test_backtest_replay.py</code> \u65b0\u898f\uff1a\u30ea\u30d7\u30ec\u30a4\u6a5f\u80fd\u306e\u30c6\u30b9\u30c8 <code>examples/marimo_replay.py</code> \u65b0\u898f\uff1amarimo\u30b5\u30f3\u30d7\u30eb\u30ce\u30fc\u30c8\u30d6\u30c3\u30af"},{"location":"plans/marimo-step-execution-plan/#9","title":"9. \u6ce8\u610f\u70b9\uff08\u8a2d\u8a08\u4e0a\u306e\u5236\u7d04\uff09","text":""},{"location":"plans/marimo-step-execution-plan/#1_1","title":"(1) \u3053\u308c\u306f\u300c\u8a55\u4fa1\u7528\u300d\u3067\u3042\u308a\u300c\u9ad8\u901f\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u300d\u3067\u306f\u306a\u3044","text":"<ul> <li>\u53ef\u8996\u5316\u4ed8\u304d\u306a\u306e\u3067\u6570\u4e07\u30d0\u30fc\u306f\u91cd\u3044</li> <li>\u5168\u671f\u9593\u306e\u9ad8\u901f\u8a55\u4fa1\u306f\u5225\u9014 <code>run()</code> \u3067\u30d0\u30c3\u30c1\u5b9f\u884c</li> </ul>"},{"location":"plans/marimo-step-execution-plan/#2-goto","title":"(2) <code>goto()</code> \u306e\u5b9f\u88c5\u306b\u3064\u3044\u3066","text":"<ul> <li>\u904e\u53bb\u306b\u623b\u308b\u5834\u5408\u306f\u30ea\u30bb\u30c3\u30c8\u3057\u3066\u518d\u5b9f\u884c\u304c\u5fc5\u8981</li> <li>\u5c06\u6765\u7684\u306b\u306f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u6a5f\u80fd\u3067\u9ad8\u901f\u5316\u53ef\u80fd</li> </ul>"},{"location":"plans/marimo-step-execution-plan/#3_1","title":"(3) \u7d04\u5b9a\u30e2\u30c7\u30eb","text":"<ul> <li><code>trade_on_close=False</code>\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09: \u6b21\u8db3\u59cb\u5024\u3067\u7d04\u5b9a</li> <li><code>trade_on_close=True</code>: \u73fe\u5728\u8db3\u7d42\u5024\u3067\u7d04\u5b9a</li> <li>\u8996\u899a\u691c\u8a3c\u3067\u306f\u7c21\u7565\u5316\u3067\u5272\u308a\u5207\u308b</li> </ul>"},{"location":"plans/marimo-step-execution-plan/#4-position","title":"(4) <code>position</code> \u30d7\u30ed\u30d1\u30c6\u30a3\u306e\u6ce8\u610f","text":"<ul> <li>\u5168\u9298\u67c4\u5408\u8a08\u306e\u305f\u3081\u3001\u8907\u6570\u9298\u67c4\u6642\u306f <code>position_of(code)</code> \u3092\u4f7f\u7528\u3059\u308b\u3053\u3068</li> <li>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u660e\u793a</li> </ul>"},{"location":"plans/marimo-step-execution-plan/#5-marimo","title":"(5) marimo \u81ea\u52d5\u518d\u751f\u306e\u5236\u9650","text":"<ul> <li>slider \u306e\u5024\u306f\u76f4\u63a5\u5909\u66f4\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u81ea\u52d5\u518d\u751f\u6642\u306f slider \u3068\u72ec\u7acb\u52d5\u4f5c</li> <li>slider \u306f\u300c\u4efb\u610f\u4f4d\u7f6e\u3078\u306e\u30b8\u30e3\u30f3\u30d7\u300d\u7528\u3068\u3057\u3066\u6b8b\u3059</li> </ul>"},{"location":"plans/marimo-step-execution-plan/#10","title":"10. \u5f8c\u7d9a\u30bf\u30b9\u30af","text":"<ul> <li> Phase 1 \u306e\u5b9f\u88c5</li> <li> Phase 2 \u306e\u5b9f\u88c5</li> <li> \u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8\u306e\u4f5c\u6210</li> <li> marimo\u30b5\u30f3\u30d7\u30eb\u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u306e\u4f5c\u6210</li> </ul>"}]}